<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Sparse regression with paired covariates</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Sparse regression with paired covariates</h1>



<p>Code for reproducing the results shown in the manuscript.</p>
<div id="initialisation" class="section level1">
<h1>Initialisation</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">### Loading functions. </span><span class="al">###</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>inst &lt;-<span class="st"> </span><span class="kw">rownames</span>(utils<span class="op">::</span><span class="kw">installed.packages</span>())</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a>cran &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;devtools&quot;</span>,<span class="st">&quot;R.utils&quot;</span>,<span class="st">&quot;Matrix&quot;</span>,<span class="st">&quot;glmnet&quot;</span>,<span class="st">&quot;pROC&quot;</span>,<span class="st">&quot;BiocManager&quot;</span>,<span class="st">&quot;ashr&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># &quot;googledrive&quot;, &quot;httpuv&quot;</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">all</span>(cran <span class="op">%in%</span><span class="st"> </span>inst)){</span>
<span id="cb1-8"><a href="#cb1-8"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(cran)){</span>
<span id="cb1-9"><a href="#cb1-9"></a>        <span class="cf">if</span>(<span class="op">!</span>cran[i] <span class="op">%in%</span><span class="st"> </span>inst){</span>
<span id="cb1-10"><a href="#cb1-10"></a>            <span class="kw">install.packages</span>(cran[i])</span>
<span id="cb1-11"><a href="#cb1-11"></a>        }</span>
<span id="cb1-12"><a href="#cb1-12"></a>    }</span>
<span id="cb1-13"><a href="#cb1-13"></a>}</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a>bioc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;edgeR&quot;</span>,<span class="st">&quot;TCGAbiolinks&quot;</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">all</span>(bioc <span class="op">%in%</span><span class="st"> </span>inst)){</span>
<span id="cb1-17"><a href="#cb1-17"></a>    <span class="co">#source(&quot;http://bioconductor.org/biocLite.R&quot;)</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(bioc)){</span>
<span id="cb1-19"><a href="#cb1-19"></a>        <span class="cf">if</span>(<span class="op">!</span>bioc[i] <span class="op">%in%</span><span class="st"> </span>inst){</span>
<span id="cb1-20"><a href="#cb1-20"></a>            <span class="co">#biocLite(bioc[i])</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>            BiocManager<span class="op">::</span><span class="kw">install</span>(bioc[i])</span>
<span id="cb1-22"><a href="#cb1-22"></a>        }</span>
<span id="cb1-23"><a href="#cb1-23"></a>    }</span>
<span id="cb1-24"><a href="#cb1-24"></a>}</span>
<span id="cb1-25"><a href="#cb1-25"></a></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co">#if(!&quot;ashr&quot; %in% inst){</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co">#  devtools::install_github(&quot;stephens999/ashr&quot;)</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="co">#}</span></span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a>user &lt;-<span class="st"> </span><span class="kw">Sys.getenv</span>(<span class="st">&quot;USERNAME&quot;</span>)</span>
<span id="cb1-31"><a href="#cb1-31"></a>path &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="st">&quot;C:&quot;</span>,<span class="st">&quot;Users&quot;</span>,user,<span class="st">&quot;Desktop&quot;</span>,<span class="st">&quot;palasso&quot;</span>)</span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="cf">if</span>(user<span class="op">==</span><span class="st">&quot;arra&quot;</span>){path &lt;-<span class="st"> &quot;C:/Users/arra/Desktop/MATHS/palasso_desktop&quot;</span>}</span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="cf">if</span>(user<span class="op">==</span><span class="st">&quot;&quot;</span>){path &lt;-<span class="st"> &quot;/virdir/Scratch/arauschenberger/palasso&quot;</span>}</span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="kw">setwd</span>(path)</span>
<span id="cb1-35"><a href="#cb1-35"></a>folders &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;results&quot;</span>)</span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="kw">invisible</span>(<span class="kw">sapply</span>(folders,<span class="cf">function</span>(x) <span class="cf">if</span>(<span class="op">!</span><span class="kw">dir.exists</span>(x)){<span class="kw">dir.create</span>(x)}))</span>
<span id="cb1-37"><a href="#cb1-37"></a></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="cf">if</span>(user<span class="op">!=</span><span class="st">&quot;arra&quot;</span>){</span>
<span id="cb1-39"><a href="#cb1-39"></a>    devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;kkdey/CorShrink&quot;</span>) <span class="co"># ref=&quot;a9f6ba0&quot;</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>    devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;rauschenberger/palasso&quot;</span>) <span class="co"># ref=&quot;4a995a2&quot;</span></span>
<span id="cb1-41"><a href="#cb1-41"></a>}</span>
<span id="cb1-42"><a href="#cb1-42"></a></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="cf">if</span>(<span class="ot">FALSE</span>){</span>
<span id="cb1-44"><a href="#cb1-44"></a>    </span>
<span id="cb1-45"><a href="#cb1-45"></a>    <span class="co"># The functions &lt;&lt;save&gt;&gt;, &lt;&lt;file.exists&gt;&gt; and &lt;&lt;file.remove&gt;&gt; access the hard disk, but also try to access googledrive.</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>    </span>
<span id="cb1-47"><a href="#cb1-47"></a>    save &lt;-<span class="st"> </span><span class="cf">function</span>(object,file){</span>
<span id="cb1-48"><a href="#cb1-48"></a>        base<span class="op">::</span><span class="kw">save</span>(object,<span class="dt">file=</span>file)</span>
<span id="cb1-49"><a href="#cb1-49"></a>        <span class="kw">tryCatch</span>(<span class="dt">expr=</span>googledrive<span class="op">::</span><span class="kw">drive_upload</span>(<span class="dt">media=</span>file,<span class="dt">path=</span>file),</span>
<span id="cb1-50"><a href="#cb1-50"></a>                 <span class="dt">error=</span><span class="cf">function</span>(x) <span class="ot">NULL</span>)</span>
<span id="cb1-51"><a href="#cb1-51"></a>        <span class="co">#Sys.sleep(0.5)</span></span>
<span id="cb1-52"><a href="#cb1-52"></a>    }</span>
<span id="cb1-53"><a href="#cb1-53"></a></span>
<span id="cb1-54"><a href="#cb1-54"></a>    file.exists &lt;-<span class="st"> </span><span class="cf">function</span>(file){</span>
<span id="cb1-55"><a href="#cb1-55"></a>        offline &lt;-<span class="st"> </span>base<span class="op">::</span><span class="kw">file.exists</span>(file)</span>
<span id="cb1-56"><a href="#cb1-56"></a>        online &lt;-<span class="st"> </span><span class="ot">FALSE</span></span>
<span id="cb1-57"><a href="#cb1-57"></a>        <span class="cf">if</span>(<span class="op">!</span>offline){</span>
<span id="cb1-58"><a href="#cb1-58"></a>            d &lt;-<span class="st"> </span>googledrive<span class="op">::</span><span class="kw">as_dribble</span>(<span class="dt">x=</span>file)</span>
<span id="cb1-59"><a href="#cb1-59"></a>            online &lt;-<span class="st"> </span><span class="kw">tryCatch</span>(<span class="dt">expr=</span>googledrive<span class="op">::</span><span class="kw">some_files</span>(d),</span>
<span id="cb1-60"><a href="#cb1-60"></a>                               <span class="dt">error=</span><span class="cf">function</span>(x) <span class="ot">FALSE</span>)</span>
<span id="cb1-61"><a href="#cb1-61"></a>            <span class="co">#Sys.sleep(0.5)</span></span>
<span id="cb1-62"><a href="#cb1-62"></a>        }</span>
<span id="cb1-63"><a href="#cb1-63"></a>        <span class="kw">return</span>(offline<span class="op">|</span>online)</span>
<span id="cb1-64"><a href="#cb1-64"></a>    }</span>
<span id="cb1-65"><a href="#cb1-65"></a></span>
<span id="cb1-66"><a href="#cb1-66"></a>    file.remove &lt;-<span class="st"> </span><span class="cf">function</span>(file){</span>
<span id="cb1-67"><a href="#cb1-67"></a>        base<span class="op">::</span><span class="kw">file.remove</span>(file)</span>
<span id="cb1-68"><a href="#cb1-68"></a>        <span class="kw">tryCatch</span>(<span class="dt">expr=</span>googledrive<span class="op">::</span><span class="kw">drive_trash</span>(<span class="dt">file=</span>file),</span>
<span id="cb1-69"><a href="#cb1-69"></a>             <span class="dt">error=</span><span class="cf">function</span>(x) <span class="ot">NULL</span>)</span>
<span id="cb1-70"><a href="#cb1-70"></a>        <span class="co">#Sys.sleep(0.5)</span></span>
<span id="cb1-71"><a href="#cb1-71"></a>    }</span>
<span id="cb1-72"><a href="#cb1-72"></a>    </span>
<span id="cb1-73"><a href="#cb1-73"></a>    </span>
<span id="cb1-74"><a href="#cb1-74"></a><span class="co"># The function &lt;&lt;update&gt;&gt; moves files from the research cloud to the remote drive. Given both paths, it first verifies whether the folders SIM, GDC and CCA are available, and then copies all missing files from the research cloud to the remote drive.</span></span>
<span id="cb1-75"><a href="#cb1-75"></a></span>
<span id="cb1-76"><a href="#cb1-76"></a><span class="co"># from: path to the origin</span></span>
<span id="cb1-77"><a href="#cb1-77"></a><span class="co"># to: path to the destination</span></span>
<span id="cb1-78"><a href="#cb1-78"></a></span>
<span id="cb1-79"><a href="#cb1-79"></a>update &lt;-<span class="st"> </span><span class="cf">function</span>(from,to){</span>
<span id="cb1-80"><a href="#cb1-80"></a>    dir &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SIM&quot;</span>,<span class="st">&quot;GDC&quot;</span>,<span class="st">&quot;CCA&quot;</span>)</span>
<span id="cb1-81"><a href="#cb1-81"></a>    <span class="cf">if</span>(<span class="kw">any</span>(<span class="op">!</span><span class="kw">dir.exists</span>(<span class="kw">file.path</span>(from,dir)))){<span class="kw">stop</span>(<span class="st">&quot;Invalid.&quot;</span>)}</span>
<span id="cb1-82"><a href="#cb1-82"></a>    <span class="cf">if</span>(<span class="kw">any</span>(<span class="op">!</span><span class="kw">dir.exists</span>(<span class="kw">file.path</span>(to,dir)))){<span class="kw">stop</span>(<span class="st">&quot;Invalid.&quot;</span>)}</span>
<span id="cb1-83"><a href="#cb1-83"></a>    pb &lt;-<span class="st"> </span>utils<span class="op">::</span><span class="kw">txtProgressBar</span>(<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>,<span class="dt">style=</span><span class="dv">3</span>)</span>
<span id="cb1-84"><a href="#cb1-84"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(dir)){</span>
<span id="cb1-85"><a href="#cb1-85"></a>        files0 &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="kw">file.path</span>(from,dir[i]))</span>
<span id="cb1-86"><a href="#cb1-86"></a>        files1 &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="kw">file.path</span>(to,dir[i]))</span>
<span id="cb1-87"><a href="#cb1-87"></a>        names &lt;-<span class="st"> </span>files0[<span class="op">!</span>files0 <span class="op">%in%</span><span class="st"> </span>files1]</span>
<span id="cb1-88"><a href="#cb1-88"></a>        <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_along</span>(names)){</span>
<span id="cb1-89"><a href="#cb1-89"></a>            utils<span class="op">::</span><span class="kw">setTxtProgressBar</span>(<span class="dt">pb=</span>pb,<span class="dt">value=</span>(i<span class="dv">-1</span>)<span class="op">/</span><span class="dv">3</span><span class="op">+</span>(j<span class="op">*</span>i)<span class="op">/</span>(<span class="dv">3</span><span class="op">*</span><span class="kw">length</span>(names)))</span>
<span id="cb1-90"><a href="#cb1-90"></a>            <span class="kw">file.copy</span>(<span class="dt">from=</span><span class="kw">file.path</span>(from,dir[i],names[j]),</span>
<span id="cb1-91"><a href="#cb1-91"></a>                      <span class="dt">to=</span><span class="kw">file.path</span>(to,dir[i],names[j]),</span>
<span id="cb1-92"><a href="#cb1-92"></a>                      <span class="dt">copy.date=</span><span class="ot">TRUE</span>)</span>
<span id="cb1-93"><a href="#cb1-93"></a>        }</span>
<span id="cb1-94"><a href="#cb1-94"></a>        utils<span class="op">::</span><span class="kw">setTxtProgressBar</span>(<span class="dt">pb=</span>pb,<span class="dt">value=</span>i<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb1-95"><a href="#cb1-95"></a>    }</span>
<span id="cb1-96"><a href="#cb1-96"></a>}</span>
<span id="cb1-97"><a href="#cb1-97"></a></span>
<span id="cb1-98"><a href="#cb1-98"></a><span class="co"># update(from=&quot;results&quot;,to=&quot;//tsclient/N/palasso/results&quot;)</span></span>
<span id="cb1-99"><a href="#cb1-99"></a>    </span>
<span id="cb1-100"><a href="#cb1-100"></a>}</span></code></pre></div>
</div>
<div id="preparation" class="section level1">
<h1>Preparation</h1>
<p>Last data download started on 2019-03-26 (R version 3.5.3).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">### Downloading &quot;Isoform Expression Quantification&quot;. </span><span class="al">###</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>directory &lt;-<span class="st"> </span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">setwd</span>(directory)</span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># Retrieving cancer types:</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>project &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">getGDCprojects</span>()<span class="op">$</span>id</span>
<span id="cb2-11"><a href="#cb2-11"></a>project &lt;-<span class="st"> </span>project[<span class="kw">grepl</span>(<span class="dt">x=</span>project,<span class="dt">pattern=</span><span class="st">&quot;TCGA&quot;</span>)]</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># Downloading isoform expression data:</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>y &lt;-<span class="st"> </span>X &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(project)){</span>
<span id="cb2-16"><a href="#cb2-16"></a>    query &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">GDCquery</span>(<span class="dt">project=</span>project[i],</span>
<span id="cb2-17"><a href="#cb2-17"></a>                <span class="dt">data.category=</span><span class="st">&quot;Transcriptome Profiling&quot;</span>,</span>
<span id="cb2-18"><a href="#cb2-18"></a>                <span class="dt">data.type=</span><span class="st">&quot;Isoform Expression Quantification&quot;</span>)</span>
<span id="cb2-19"><a href="#cb2-19"></a>    TCGAbiolinks<span class="op">::</span><span class="kw">GDCdownload</span>(query,<span class="dt">method=</span><span class="st">&quot;api&quot;</span>,<span class="dt">directory=</span>directory)</span>
<span id="cb2-20"><a href="#cb2-20"></a>    <span class="kw">trace</span>(TCGAbiolinks<span class="op">:::</span>readTranscriptomeProfiling,<span class="dt">tracer=</span><span class="kw">quote</span>(ignore.case&lt;-<span class="ot">TRUE</span>))</span>
<span id="cb2-21"><a href="#cb2-21"></a>    X[[i]] &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">GDCprepare</span>(query,<span class="dt">directory=</span>directory)</span>
<span id="cb2-22"><a href="#cb2-22"></a>    X[[i]][,<span class="kw">c</span>(<span class="st">&quot;miRNA_ID&quot;</span>,<span class="st">&quot;reads_per_million_miRNA_mapped&quot;</span>,</span>
<span id="cb2-23"><a href="#cb2-23"></a>              <span class="st">&quot;cross-mapped&quot;</span>,<span class="st">&quot;miRNA_region&quot;</span>)] &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>    y[[i]] &lt;-<span class="st"> </span><span class="kw">rep</span>(project[i],<span class="dt">times=</span><span class="kw">length</span>(<span class="kw">unique</span>(X[[i]]<span class="op">$</span>barcode)))</span>
<span id="cb2-25"><a href="#cb2-25"></a>}</span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;isoform_raw.RData&quot;</span>))</span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="kw">load</span>(<span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;isoform_raw.RData&quot;</span>),<span class="dt">verbose=</span><span class="ot">TRUE</span>)</span>
<span id="cb2-29"><a href="#cb2-29"></a></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co"># Merging isoform expression data:</span></span>
<span id="cb2-31"><a href="#cb2-31"></a>Xs &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span>rbind,<span class="dt">args=</span>X) <span class="co"># sparse matrix</span></span>
<span id="cb2-32"><a href="#cb2-32"></a>y &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span><span class="st">&quot;c&quot;</span>,<span class="dt">args=</span>y)</span>
<span id="cb2-33"><a href="#cb2-33"></a></span>
<span id="cb2-34"><a href="#cb2-34"></a><span class="co"># Transform to matrix</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>Xs<span class="op">$</span>isoform_coords &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="dt">pattern=</span><span class="st">&quot;hg38:chr&quot;</span>,<span class="dt">replacement=</span><span class="st">&quot;&quot;</span>,<span class="dt">x=</span>Xs<span class="op">$</span>isoform_coords)</span>
<span id="cb2-36"><a href="#cb2-36"></a>samples &lt;-<span class="st"> </span><span class="kw">unique</span>(Xs<span class="op">$</span>barcode)</span>
<span id="cb2-37"><a href="#cb2-37"></a>covariates &lt;-<span class="st"> </span><span class="kw">unique</span>(Xs<span class="op">$</span>isoform_coords)</span>
<span id="cb2-38"><a href="#cb2-38"></a>row &lt;-<span class="st"> </span><span class="kw">match</span>(Xs<span class="op">$</span>barcode,samples)</span>
<span id="cb2-39"><a href="#cb2-39"></a>col &lt;-<span class="st"> </span><span class="kw">match</span>(Xs<span class="op">$</span>isoform_coords,covariates)</span>
<span id="cb2-40"><a href="#cb2-40"></a>X &lt;-<span class="st"> </span>Matrix<span class="op">::</span><span class="kw">sparseMatrix</span>(<span class="dt">i=</span>row,<span class="dt">j=</span>col,<span class="dt">x=</span>Xs<span class="op">$</span>read_count,<span class="dt">dimnames=</span><span class="kw">list</span>(samples,covariates))</span>
<span id="cb2-41"><a href="#cb2-41"></a></span>
<span id="cb2-42"><a href="#cb2-42"></a><span class="co"># Order by molecular location</span></span>
<span id="cb2-43"><a href="#cb2-43"></a>split &lt;-<span class="st"> </span><span class="kw">strsplit</span>(<span class="dt">x=</span><span class="kw">colnames</span>(X),<span class="dt">split=</span><span class="st">&quot;:|-&quot;</span>)</span>
<span id="cb2-44"><a href="#cb2-44"></a>chr &lt;-<span class="st"> </span><span class="kw">sapply</span>(split,<span class="cf">function</span>(x) x[[<span class="dv">1</span>]])</span>
<span id="cb2-45"><a href="#cb2-45"></a>pos &lt;-<span class="st"> </span><span class="kw">sapply</span>(split,<span class="cf">function</span>(x) x[[<span class="dv">2</span>]])</span>
<span id="cb2-46"><a href="#cb2-46"></a>order &lt;-<span class="st"> </span><span class="kw">order</span>(chr,pos)</span>
<span id="cb2-47"><a href="#cb2-47"></a>X &lt;-<span class="st"> </span>X[,order]</span>
<span id="cb2-48"><a href="#cb2-48"></a></span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="cf">if</span>(<span class="ot">FALSE</span>){ <span class="co"># testing</span></span>
<span id="cb2-50"><a href="#cb2-50"></a>    i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(Xs)),<span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb2-51"><a href="#cb2-51"></a>    Xs<span class="op">$</span>read_count[i]</span>
<span id="cb2-52"><a href="#cb2-52"></a>    X[Xs<span class="op">$</span>barcode[i],Xs<span class="op">$</span>isoform_coords[i]]</span>
<span id="cb2-53"><a href="#cb2-53"></a>}</span>
<span id="cb2-54"><a href="#cb2-54"></a></span>
<span id="cb2-55"><a href="#cb2-55"></a><span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;isoform_all.RData&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">### Downloading &quot;miRNA Expression Quantification&quot;. </span><span class="al">###</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>directory &lt;-<span class="st"> </span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">setwd</span>(directory)</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># Downloading data.</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>project &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">getGDCprojects</span>()<span class="op">$</span>id </span>
<span id="cb3-11"><a href="#cb3-11"></a>project &lt;-<span class="st"> </span>project[<span class="kw">grepl</span>(<span class="dt">x=</span>project,<span class="dt">pattern=</span><span class="st">&quot;TCGA&quot;</span>)]</span>
<span id="cb3-12"><a href="#cb3-12"></a>y &lt;-<span class="st"> </span>X &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(project)){</span>
<span id="cb3-14"><a href="#cb3-14"></a>    query &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">GDCquery</span>(<span class="dt">project=</span>project[i],</span>
<span id="cb3-15"><a href="#cb3-15"></a>                           <span class="dt">data.category=</span><span class="st">&quot;Transcriptome Profiling&quot;</span>,</span>
<span id="cb3-16"><a href="#cb3-16"></a>                           <span class="dt">data.type=</span><span class="st">&quot;miRNA Expression Quantification&quot;</span>)</span>
<span id="cb3-17"><a href="#cb3-17"></a>    TCGAbiolinks<span class="op">::</span><span class="kw">GDCdownload</span>(query,<span class="dt">method=</span><span class="st">&quot;api&quot;</span>,<span class="dt">directory=</span>directory)</span>
<span id="cb3-18"><a href="#cb3-18"></a>    <span class="kw">trace</span>(TCGAbiolinks<span class="op">:::</span>readTranscriptomeProfiling,<span class="dt">tracer=</span><span class="kw">quote</span>(ignore.case&lt;-<span class="ot">TRUE</span>))</span>
<span id="cb3-19"><a href="#cb3-19"></a>    data &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">GDCprepare</span>(query,<span class="dt">directory=</span>directory)</span>
<span id="cb3-20"><a href="#cb3-20"></a>    X[[i]] &lt;-<span class="st"> </span><span class="kw">t</span>(data[,<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">2</span>,<span class="dt">to=</span><span class="kw">ncol</span>(data),<span class="dt">by=</span><span class="dv">3</span>))])</span>
<span id="cb3-21"><a href="#cb3-21"></a>    y[[i]] &lt;-<span class="st"> </span><span class="kw">rep</span>(project[i],<span class="dt">times=</span><span class="kw">nrow</span>(X[[i]]))</span>
<span id="cb3-22"><a href="#cb3-22"></a>}</span>
<span id="cb3-23"><a href="#cb3-23"></a></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;miRNA_raw.RData&quot;</span>))</span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="kw">load</span>(<span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;miRNA_raw.RData&quot;</span>))</span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a>X &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span>rbind,<span class="dt">args=</span>X)</span>
<span id="cb3-28"><a href="#cb3-28"></a>y &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span><span class="st">&quot;c&quot;</span>,<span class="dt">args=</span>y)</span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="kw">rownames</span>(X) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="dt">pattern=</span><span class="st">&quot;read_count_&quot;</span>,<span class="dt">replacement=</span><span class="st">&quot;&quot;</span>,<span class="dt">x=</span><span class="kw">rownames</span>(X))</span>
<span id="cb3-30"><a href="#cb3-30"></a></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;miRNA_all.RData&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">### Downloading &quot;Gene Expression Quantification&quot;. </span><span class="al">###</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>directory &lt;-<span class="st"> </span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">setwd</span>(directory)</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># Retrieving cancer types:</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>project &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">getGDCprojects</span>()<span class="op">$</span>id</span>
<span id="cb4-11"><a href="#cb4-11"></a>project &lt;-<span class="st"> </span>project[<span class="kw">grepl</span>(<span class="dt">x=</span>project,<span class="dt">pattern=</span><span class="st">&quot;TCGA&quot;</span>)]</span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co"># Downloading data:</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="kw">memory.limit</span>(<span class="dt">size=</span><span class="dv">16000</span>) <span class="co"># Activate virtual memory in system control!</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>y &lt;-<span class="st"> </span>X &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(project)){</span>
<span id="cb4-17"><a href="#cb4-17"></a>    query &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">GDCquery</span>(<span class="dt">project=</span>project[i],</span>
<span id="cb4-18"><a href="#cb4-18"></a>                <span class="dt">data.category=</span><span class="st">&quot;Transcriptome Profiling&quot;</span>,</span>
<span id="cb4-19"><a href="#cb4-19"></a>                <span class="dt">data.type=</span><span class="st">&quot;Gene Expression Quantification&quot;</span>,</span>
<span id="cb4-20"><a href="#cb4-20"></a>                <span class="dt">workflow.type=</span><span class="st">&quot;HTSeq - Counts&quot;</span>); <span class="kw">gc</span>()</span>
<span id="cb4-21"><a href="#cb4-21"></a>    TCGAbiolinks<span class="op">::</span><span class="kw">GDCdownload</span>(<span class="dt">query=</span>query,<span class="dt">method=</span><span class="st">&quot;api&quot;</span>,<span class="dt">directory=</span>directory); <span class="kw">gc</span>()</span>
<span id="cb4-22"><a href="#cb4-22"></a>    <span class="kw">trace</span>(TCGAbiolinks<span class="op">:::</span>readTranscriptomeProfiling,<span class="dt">tracer=</span><span class="kw">quote</span>(ignore.case&lt;-<span class="ot">TRUE</span>)); <span class="kw">gc</span>()</span>
<span id="cb4-23"><a href="#cb4-23"></a>    X[[i]] &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">GDCprepare</span>(query,<span class="dt">directory=</span>directory); <span class="kw">gc</span>()</span>
<span id="cb4-24"><a href="#cb4-24"></a>    y[[i]] &lt;-<span class="st"> </span><span class="kw">rep</span>(project[i],<span class="dt">times=</span><span class="kw">ncol</span>(X[[i]])); <span class="kw">gc</span>()</span>
<span id="cb4-25"><a href="#cb4-25"></a>}</span>
<span id="cb4-26"><a href="#cb4-26"></a></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;gene_raw.RData&quot;</span>))</span>
<span id="cb4-28"><a href="#cb4-28"></a><span class="kw">load</span>(<span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;gene_raw.RData&quot;</span>))</span>
<span id="cb4-29"><a href="#cb4-29"></a></span>
<span id="cb4-30"><a href="#cb4-30"></a>genes &lt;-<span class="st"> </span>SummarizedExperiment<span class="op">::</span><span class="kw">rowData</span>(X[[<span class="dv">1</span>]])</span>
<span id="cb4-31"><a href="#cb4-31"></a>mart &lt;-<span class="st"> </span>biomaRt<span class="op">::</span><span class="kw">useMart</span>(<span class="st">&quot;ensembl&quot;</span>,<span class="dt">dataset=</span><span class="st">&quot;hsapiens_gene_ensembl&quot;</span>) <span class="co"># </span></span>
<span id="cb4-32"><a href="#cb4-32"></a>char &lt;-<span class="st"> </span>biomaRt<span class="op">::</span><span class="kw">getBM</span>(<span class="dt">attributes=</span><span class="kw">c</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>,<span class="st">&quot;chromosome_name&quot;</span>,<span class="st">&quot;transcript_start&quot;</span>,<span class="st">&quot;gene_biotype&quot;</span>),<span class="dt">filters=</span><span class="kw">c</span>(<span class="st">&quot;biotype&quot;</span>,<span class="st">&quot;chromosome_name&quot;</span>),<span class="dt">values=</span><span class="kw">list</span>(<span class="st">&quot;protein_coding&quot;</span>,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">22</span>,<span class="st">&quot;X&quot;</span>)),<span class="dt">mart=</span>mart)</span>
<span id="cb4-33"><a href="#cb4-33"></a>select &lt;-<span class="st"> </span>genes<span class="op">$</span>ensembl_gene_id[genes<span class="op">$</span>ensembl_gene_id <span class="op">%in%</span><span class="st"> </span>char<span class="op">$</span>ensembl_gene_id]</span>
<span id="cb4-34"><a href="#cb4-34"></a></span>
<span id="cb4-35"><a href="#cb4-35"></a>X &lt;-<span class="st"> </span><span class="kw">lapply</span>(X,<span class="cf">function</span>(x) <span class="kw">t</span>(SummarizedExperiment<span class="op">::</span><span class="kw">assays</span>(x)<span class="op">$</span><span class="st">&quot;HTSeq - Counts&quot;</span>[select,]))</span>
<span id="cb4-36"><a href="#cb4-36"></a>X &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span>rbind,<span class="dt">args=</span>X)</span>
<span id="cb4-37"><a href="#cb4-37"></a>y &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span><span class="st">&quot;c&quot;</span>,<span class="dt">args=</span>y)</span>
<span id="cb4-38"><a href="#cb4-38"></a></span>
<span id="cb4-39"><a href="#cb4-39"></a><span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;gene_all.RData&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">### Downloading &quot;Copy Number Variation&quot;. </span><span class="al">###</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a>directory &lt;-<span class="st"> </span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="kw">setwd</span>(directory)</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a>project &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">getGDCprojects</span>()<span class="op">$</span>id</span>
<span id="cb5-10"><a href="#cb5-10"></a>project &lt;-<span class="st"> </span>project[<span class="kw">grepl</span>(<span class="dt">x=</span>project,<span class="dt">pattern=</span><span class="st">&quot;TCGA&quot;</span>)]</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a>y &lt;-<span class="st"> </span>X &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(project)){</span>
<span id="cb5-14"><a href="#cb5-14"></a>    query &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">GDCquery</span>(<span class="dt">project=</span>project[i],</span>
<span id="cb5-15"><a href="#cb5-15"></a>                <span class="dt">data.category=</span><span class="st">&quot;Copy Number Variation&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16"></a>                <span class="dt">data.type=</span><span class="st">&quot;Masked Copy Number Segment&quot;</span>)</span>
<span id="cb5-17"><a href="#cb5-17"></a>    TCGAbiolinks<span class="op">::</span><span class="kw">GDCdownload</span>(<span class="dt">query=</span>query,<span class="dt">method=</span><span class="st">&quot;api&quot;</span>,<span class="dt">directory=</span>directory)</span>
<span id="cb5-18"><a href="#cb5-18"></a>    <span class="kw">trace</span>(TCGAbiolinks<span class="op">:::</span>readTranscriptomeProfiling,<span class="dt">tracer=</span><span class="kw">quote</span>(ignore.case&lt;-<span class="ot">TRUE</span>))</span>
<span id="cb5-19"><a href="#cb5-19"></a>    X[[i]] &lt;-<span class="st"> </span>TCGAbiolinks<span class="op">::</span><span class="kw">GDCprepare</span>(query,<span class="dt">directory=</span>directory)</span>
<span id="cb5-20"><a href="#cb5-20"></a>    y[[i]] &lt;-<span class="st"> </span><span class="kw">rep</span>(project[i],<span class="dt">times=</span><span class="kw">length</span>(<span class="kw">unique</span>(X[[i]]<span class="op">$</span>Sample))) <span class="co"># correct?</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>}</span>
<span id="cb5-22"><a href="#cb5-22"></a></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;CNV_raw.RData&quot;</span>))</span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="kw">load</span>(<span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;CNV_raw.RData&quot;</span>),<span class="dt">verbose=</span><span class="ot">TRUE</span>)</span>
<span id="cb5-25"><a href="#cb5-25"></a></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co"># Merging CNV data:</span></span>
<span id="cb5-27"><a href="#cb5-27"></a>Xs &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span>rbind,<span class="dt">args=</span>X) <span class="co"># sparse matrix</span></span>
<span id="cb5-28"><a href="#cb5-28"></a>y &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span><span class="st">&quot;c&quot;</span>,<span class="dt">args=</span>y)</span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">#table(Xs$Sample)</span></span>
<span id="cb5-30"><a href="#cb5-30"></a></span>
<span id="cb5-31"><a href="#cb5-31"></a><span class="co"># Prepare cutting.</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>cut &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb5-33"><a href="#cb5-33"></a>cut<span class="op">$</span>chr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">22</span>,<span class="st">&quot;X&quot;</span>)</span>
<span id="cb5-34"><a href="#cb5-34"></a>cut<span class="op">$</span>start &lt;-<span class="st"> </span><span class="kw">sapply</span>(cut<span class="op">$</span>chr,<span class="cf">function</span>(x) <span class="kw">min</span>(Xs<span class="op">$</span>Start[Xs<span class="op">$</span>Chromosome<span class="op">==</span>x]))</span>
<span id="cb5-35"><a href="#cb5-35"></a>cut<span class="op">$</span>end &lt;-<span class="st"> </span><span class="kw">sapply</span>(cut<span class="op">$</span>chr,<span class="cf">function</span>(x) <span class="kw">max</span>(Xs<span class="op">$</span>End[Xs<span class="op">$</span>Chromosome<span class="op">==</span>x]))</span>
<span id="cb5-36"><a href="#cb5-36"></a>cut<span class="op">$</span>length &lt;-<span class="st"> </span>cut<span class="op">$</span>end<span class="op">-</span>cut<span class="op">$</span>start</span>
<span id="cb5-37"><a href="#cb5-37"></a>cut<span class="op">$</span>dist &lt;-<span class="st"> </span><span class="kw">sum</span>(cut<span class="op">$</span>length)<span class="op">/</span><span class="dv">10000</span></span>
<span id="cb5-38"><a href="#cb5-38"></a>cut<span class="op">$</span>num &lt;-<span class="st"> </span><span class="kw">round</span>(cut<span class="op">$</span>length<span class="op">/</span>cut<span class="op">$</span>dist)</span>
<span id="cb5-39"><a href="#cb5-39"></a></span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="co"># Create covariates.</span></span>
<span id="cb5-41"><a href="#cb5-41"></a>cov &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb5-42"><a href="#cb5-42"></a>cov<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">sum</span>(cut<span class="op">$</span>num)</span>
<span id="cb5-43"><a href="#cb5-43"></a>cov<span class="op">$</span>chromosome &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">sapply</span>(cut<span class="op">$</span>chr,<span class="cf">function</span>(i) <span class="kw">rep</span>(i,<span class="dt">times=</span>cut<span class="op">$</span>num[i])))</span>
<span id="cb5-44"><a href="#cb5-44"></a>cov<span class="op">$</span>location &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">sapply</span>(cut<span class="op">$</span>chr,<span class="cf">function</span>(i) <span class="kw">round</span>(<span class="kw">seq</span>(<span class="dt">from=</span>cut<span class="op">$</span>start[i],<span class="dt">to=</span>cut<span class="op">$</span>end[i],<span class="dt">length.out=</span>cut<span class="op">$</span>num[i]))))</span>
<span id="cb5-45"><a href="#cb5-45"></a>cov<span class="op">$</span>name &lt;-<span class="st"> </span><span class="kw">paste0</span>(cov<span class="op">$</span>chromosome,<span class="st">&quot;:&quot;</span>,cov<span class="op">$</span>location)</span>
<span id="cb5-46"><a href="#cb5-46"></a></span>
<span id="cb5-47"><a href="#cb5-47"></a><span class="co"># Create indices for each covariate.</span></span>
<span id="cb5-48"><a href="#cb5-48"></a>index &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">list</span>(<span class="kw">integer</span>()),<span class="dt">times=</span>cov<span class="op">$</span>p)</span>
<span id="cb5-49"><a href="#cb5-49"></a>pb &lt;-<span class="st"> </span>utils<span class="op">::</span><span class="kw">txtProgressBar</span>(<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>cov<span class="op">$</span>p,<span class="dt">style=</span><span class="dv">3</span>)</span>
<span id="cb5-50"><a href="#cb5-50"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_len</span>(cov<span class="op">$</span>p)){</span>
<span id="cb5-51"><a href="#cb5-51"></a>    utils<span class="op">::</span><span class="kw">setTxtProgressBar</span>(<span class="dt">pb=</span>pb,<span class="dt">value=</span>j)</span>
<span id="cb5-52"><a href="#cb5-52"></a>    index[[j]] &lt;-<span class="st"> </span><span class="kw">which</span>((Xs<span class="op">$</span>Chromosome<span class="op">==</span>cov<span class="op">$</span>chromosome[j]) <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb5-53"><a href="#cb5-53"></a><span class="st">        </span>(Xs<span class="op">$</span>Start<span class="op">&lt;=</span>cov<span class="op">$</span>location[j]) <span class="op">&amp;</span><span class="st"> </span>(cov<span class="op">$</span>location[j]<span class="op">&lt;=</span>Xs<span class="op">$</span>End)) <span class="co"># consider &lt;</span></span>
<span id="cb5-54"><a href="#cb5-54"></a>}</span>
<span id="cb5-55"><a href="#cb5-55"></a></span>
<span id="cb5-56"><a href="#cb5-56"></a><span class="co"># Expand indices to matrix.</span></span>
<span id="cb5-57"><a href="#cb5-57"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span><span class="kw">length</span>(<span class="kw">unique</span>(Xs<span class="op">$</span>Sample)),<span class="dt">ncol=</span>cov<span class="op">$</span>p,</span>
<span id="cb5-58"><a href="#cb5-58"></a>             <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">unique</span>(Xs<span class="op">$</span>Sample),cov<span class="op">$</span>name))</span>
<span id="cb5-59"><a href="#cb5-59"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_along</span>(index)){</span>
<span id="cb5-60"><a href="#cb5-60"></a>    mean &lt;-<span class="st"> </span>Xs<span class="op">$</span>Segment_Mean[index[[j]]]</span>
<span id="cb5-61"><a href="#cb5-61"></a>    i &lt;-<span class="st"> </span>Xs<span class="op">$</span>Sample[index[[j]]]</span>
<span id="cb5-62"><a href="#cb5-62"></a>    X[i,j] &lt;-<span class="st"> </span>mean</span>
<span id="cb5-63"><a href="#cb5-63"></a>}</span>
<span id="cb5-64"><a href="#cb5-64"></a></span>
<span id="cb5-65"><a href="#cb5-65"></a><span class="cf">if</span>(<span class="ot">FALSE</span>){ <span class="co"># test</span></span>
<span id="cb5-66"><a href="#cb5-66"></a>    sample &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rownames</span>(X),<span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb5-67"><a href="#cb5-67"></a>    covariate &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">colnames</span>(X),<span class="dt">size=</span><span class="dv">1</span>)</span>
<span id="cb5-68"><a href="#cb5-68"></a>    split &lt;-<span class="st"> </span><span class="kw">strsplit</span>(covariate,<span class="dt">split=</span><span class="st">&quot;:&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb5-69"><a href="#cb5-69"></a>    a &lt;-<span class="st"> </span>X[sample,covariate]</span>
<span id="cb5-70"><a href="#cb5-70"></a>    b &lt;-<span class="st"> </span>Xs<span class="op">$</span>Segment_Mean[(Xs<span class="op">$</span>Sample<span class="op">==</span>sample) <span class="op">&amp;</span><span class="st"> </span>(Xs<span class="op">$</span>Chromosome<span class="op">==</span>split[<span class="dv">1</span>]) <span class="op">&amp;</span><span class="st"> </span>(Xs<span class="op">$</span>Start<span class="op">&lt;=</span><span class="kw">as.numeric</span>(split[<span class="dv">2</span>])) <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">as.numeric</span>(split[<span class="dv">2</span>]) <span class="op">&lt;</span><span class="st"> </span>Xs<span class="op">$</span>End)]</span>
<span id="cb5-71"><a href="#cb5-71"></a>    <span class="kw">all</span>(a<span class="op">==</span>b)</span>
<span id="cb5-72"><a href="#cb5-72"></a>}</span>
<span id="cb5-73"><a href="#cb5-73"></a></span>
<span id="cb5-74"><a href="#cb5-74"></a><span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>,<span class="st">&quot;index&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="st">&quot;CNV_all.RData&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">### Extracting samples of interest. </span><span class="al">###</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a>type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;CNV&quot;</span>,<span class="st">&quot;gene&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(type)){</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="kw">cat</span>(type[i],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="kw">load</span>(<span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="kw">paste0</span>(type[i],<span class="st">&quot;_all.RData&quot;</span>)),<span class="dt">verbose=</span><span class="ot">TRUE</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a>    </span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="co"># TCGA barcode</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>    barcode &lt;-<span class="st"> </span><span class="kw">rownames</span>(X)</span>
<span id="cb6-14"><a href="#cb6-14"></a>    code &lt;-<span class="st"> </span><span class="kw">sapply</span>(barcode,<span class="cf">function</span>(x) <span class="kw">strsplit</span>(x,<span class="dt">split=</span><span class="st">&quot;-&quot;</span>))</span>
<span id="cb6-15"><a href="#cb6-15"></a>    code &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">do.call</span>(<span class="dt">what=</span>rbind,<span class="dt">args=</span>code))</span>
<span id="cb6-16"><a href="#cb6-16"></a>    <span class="kw">colnames</span>(code) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;project&quot;</span>,<span class="st">&quot;TSS&quot;</span>,<span class="st">&quot;participant&quot;</span>,<span class="st">&quot;sample_vial&quot;</span>,</span>
<span id="cb6-17"><a href="#cb6-17"></a>                        <span class="st">&quot;portion_analyte&quot;</span>,<span class="st">&quot;plate&quot;</span>,<span class="st">&quot;center&quot;</span>)</span>
<span id="cb6-18"><a href="#cb6-18"></a>    code<span class="op">$</span>sample &lt;-<span class="st"> </span><span class="kw">substr</span>(code<span class="op">$</span>sample_vial,<span class="dt">start=</span><span class="dv">1</span>,<span class="dt">stop=</span><span class="dv">2</span>)</span>
<span id="cb6-19"><a href="#cb6-19"></a>    code<span class="op">$</span>vial &lt;-<span class="st"> </span><span class="kw">substr</span>(code<span class="op">$</span>sample_vial,<span class="dt">start=</span><span class="dv">3</span>,<span class="dt">stop=</span><span class="dv">3</span>)</span>
<span id="cb6-20"><a href="#cb6-20"></a>    code<span class="op">$</span>portion &lt;-<span class="st"> </span><span class="kw">substr</span>(code<span class="op">$</span>portion_analyte,<span class="dt">start=</span><span class="dv">1</span>,<span class="dt">stop=</span><span class="dv">2</span>)</span>
<span id="cb6-21"><a href="#cb6-21"></a>    code<span class="op">$</span>analyte &lt;-<span class="st"> </span><span class="kw">substr</span>(code<span class="op">$</span>portion_analyte,<span class="dt">start=</span><span class="dv">3</span>,<span class="dt">stop=</span><span class="dv">3</span>)</span>
<span id="cb6-22"><a href="#cb6-22"></a>    code<span class="op">$</span>sample_vial &lt;-<span class="st"> </span>code<span class="op">$</span>portion_analyte &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>    </span>
<span id="cb6-24"><a href="#cb6-24"></a>    <span class="co"># solid tumour (except blood for LAML)</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>    solid &lt;-<span class="st"> </span>(code<span class="op">$</span>sample<span class="op">==</span><span class="st">&quot;01&quot;</span> <span class="op">|</span><span class="st"> </span>(y<span class="op">==</span><span class="st">&quot;TCGA-LAML&quot;</span> <span class="op">&amp;</span><span class="st"> </span>code<span class="op">$</span>sample<span class="op">==</span><span class="st">&quot;03&quot;</span>))</span>
<span id="cb6-26"><a href="#cb6-26"></a>    X &lt;-<span class="st"> </span>X[solid,]</span>
<span id="cb6-27"><a href="#cb6-27"></a>    y &lt;-<span class="st"> </span>y[solid]</span>
<span id="cb6-28"><a href="#cb6-28"></a></span>
<span id="cb6-29"><a href="#cb6-29"></a>    <span class="co"># unique samples</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>    unique &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">duplicated</span>(<span class="kw">substr</span>(<span class="kw">rownames</span>(X),<span class="dt">start=</span><span class="dv">1</span>,<span class="dt">stop=</span><span class="dv">12</span>))</span>
<span id="cb6-31"><a href="#cb6-31"></a>    X &lt;-<span class="st"> </span>X[unique,]</span>
<span id="cb6-32"><a href="#cb6-32"></a>    y &lt;-<span class="st"> </span>y[unique]</span>
<span id="cb6-33"><a href="#cb6-33"></a>    </span>
<span id="cb6-34"><a href="#cb6-34"></a>    <span class="kw">save</span>(<span class="dt">list=</span><span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;X&quot;</span>),<span class="dt">file=</span><span class="kw">file.path</span>(path,<span class="st">&quot;data&quot;</span>,<span class="kw">paste0</span>(type[i],<span class="st">&quot;_sub.RData&quot;</span>)))</span>
<span id="cb6-35"><a href="#cb6-35"></a>}</span>
<span id="cb6-36"><a href="#cb6-36"></a></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co"># isoform: n=9&#39;794, p=194&#39;595, k=32</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co"># miRNA: n=9&#39;794, p=1&#39;881, k=32</span></span>
<span id="cb6-39"><a href="#cb6-39"></a><span class="co"># gene: n=9&#39;830, p=19&#39;602, k=33</span></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="co"># CNV: n=10&#39;578, p=10&#39;000, k=33</span></span>
<span id="cb6-41"><a href="#cb6-41"></a></span>
<span id="cb6-42"><a href="#cb6-42"></a><span class="co">## Understanding barcodes:</span></span>
<span id="cb6-43"><a href="#cb6-43"></a><span class="co"># overview: https://wiki.nci.nih.gov/display/TCGA/TCGA+barcode</span></span>
<span id="cb6-44"><a href="#cb6-44"></a><span class="co"># details: https://gdc.cancer.gov/resources-tcga-users/tcga-code-tables</span></span>
<span id="cb6-45"><a href="#cb6-45"></a></span>
<span id="cb6-46"><a href="#cb6-46"></a><span class="co">## Understanding replicate samples:</span></span>
<span id="cb6-47"><a href="#cb6-47"></a><span class="co"># http://gdac.broadinstitute.org/runs/sampleReports/latest/READ_Replicate_Samples.html</span></span></code></pre></div>
</div>
<div id="analysis" class="section level1">
<h1>Analysis</h1>
<p>Last data analysis started on 2019-04-12 (R version 3.5.3).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">### Analysing the TCGA data. </span><span class="al">###</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="cf">for</span>(type <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;CNV&quot;</span>,<span class="st">&quot;gene&quot;</span>)){ </span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="kw">library</span>(Matrix)</span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">207</span>,<span class="kw">sample</span>(<span class="dv">528</span>))){</span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="kw">set.seed</span>(k); <span class="kw">cat</span>(k,<span class="st">&quot; &quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="cf">if</span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>k <span class="op">&gt;</span><span class="st"> </span><span class="dv">496</span>){<span class="cf">next</span>}</span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="cf">if</span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CNV&quot;</span>,<span class="st">&quot;gene&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>k <span class="op">&gt;</span><span class="st"> </span><span class="dv">528</span>){<span class="cf">next</span>}</span>
<span id="cb7-12"><a href="#cb7-12"></a>    </span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="co"># searching for missing cancer-cancer combinations</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>    <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">setdiff</span>(<span class="kw">ls</span>(),<span class="kw">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;type&quot;</span>,<span class="st">&quot;path&quot;</span>,<span class="st">&quot;save&quot;</span>,<span class="st">&quot;file.exists&quot;</span>,<span class="st">&quot;file.remove&quot;</span>))); <span class="kw">gc</span>()</span>
<span id="cb7-15"><a href="#cb7-15"></a>    file0 &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;results/&quot;</span>,type,<span class="st">&quot;_start_&quot;</span>,k,<span class="st">&quot;.RData&quot;</span>)</span>
<span id="cb7-16"><a href="#cb7-16"></a>    file1 &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;results/&quot;</span>,type,<span class="st">&quot;_loss_&quot;</span>,k,<span class="st">&quot;.RData&quot;</span>)</span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="cf">if</span>(<span class="kw">file.exists</span>(file0)<span class="op">||</span><span class="kw">file.exists</span>(file1)){<span class="cf">next</span>}</span>
<span id="cb7-18"><a href="#cb7-18"></a>    <span class="kw">save</span>(<span class="dt">object=</span>k,<span class="dt">file=</span>file0)</span>
<span id="cb7-19"><a href="#cb7-19"></a>    <span class="kw">load</span>(<span class="kw">paste0</span>(<span class="st">&quot;data/&quot;</span>,type,<span class="st">&quot;_sub.RData&quot;</span>))</span>
<span id="cb7-20"><a href="#cb7-20"></a>    </span>
<span id="cb7-21"><a href="#cb7-21"></a>    <span class="co"># indicating the cancer-cancer combination</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>    cancer &lt;-<span class="st"> </span><span class="kw">substring</span>(<span class="dt">text=</span><span class="kw">unique</span>(y),<span class="dt">first=</span><span class="dv">6</span>)</span>
<span id="cb7-23"><a href="#cb7-23"></a>    comb &lt;-<span class="st"> </span>utils<span class="op">::</span><span class="kw">combn</span>(<span class="dt">x=</span>cancer,<span class="dt">m=</span><span class="dv">2</span>)</span>
<span id="cb7-24"><a href="#cb7-24"></a>    select &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;TCGA-&quot;</span>,comb[,k])</span>
<span id="cb7-25"><a href="#cb7-25"></a>    y &lt;-<span class="st"> </span><span class="kw">ifelse</span>(y<span class="op">==</span>select[<span class="dv">1</span>],<span class="dv">1</span>,<span class="kw">ifelse</span>(y<span class="op">==</span>select[<span class="dv">2</span>],<span class="dv">0</span>,<span class="ot">NA</span>))</span>
<span id="cb7-26"><a href="#cb7-26"></a>    <span class="kw">rm</span>(cancer,select)</span>
<span id="cb7-27"><a href="#cb7-27"></a>    </span>
<span id="cb7-28"><a href="#cb7-28"></a>    <span class="co"># removing other cancer types</span></span>
<span id="cb7-29"><a href="#cb7-29"></a>    cond &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(y)</span>
<span id="cb7-30"><a href="#cb7-30"></a>    y &lt;-<span class="st"> </span>y[cond]</span>
<span id="cb7-31"><a href="#cb7-31"></a>    X &lt;-<span class="st"> </span>X[cond,]</span>
<span id="cb7-32"><a href="#cb7-32"></a>    <span class="kw">rm</span>(cond)</span>
<span id="cb7-33"><a href="#cb7-33"></a>    </span>
<span id="cb7-34"><a href="#cb7-34"></a>    <span class="co"># pre-processing</span></span>
<span id="cb7-35"><a href="#cb7-35"></a>    <span class="cf">if</span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>)){</span>
<span id="cb7-36"><a href="#cb7-36"></a>      x &lt;-<span class="st"> </span>palasso<span class="op">:::</span><span class="kw">.prepare</span>(X,<span class="dt">cutoff=</span><span class="st">&quot;zero&quot;</span>)</span>
<span id="cb7-37"><a href="#cb7-37"></a>    } <span class="cf">else</span> <span class="cf">if</span>(type<span class="op">==</span><span class="st">&quot;gene&quot;</span>){</span>
<span id="cb7-38"><a href="#cb7-38"></a>      x &lt;-<span class="st"> </span>palasso<span class="op">:::</span><span class="kw">.prepare</span>(X,<span class="dt">cutoff=</span><span class="st">&quot;knee&quot;</span>)</span>
<span id="cb7-39"><a href="#cb7-39"></a>    } <span class="cf">else</span> <span class="cf">if</span>(type<span class="op">==</span><span class="st">&quot;CNV&quot;</span>){</span>
<span id="cb7-40"><a href="#cb7-40"></a>      x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">X=</span>X,<span class="dt">Z=</span><span class="kw">sign</span>(X))</span>
<span id="cb7-41"><a href="#cb7-41"></a>      x &lt;-<span class="st"> </span><span class="kw">lapply</span>(x,<span class="cf">function</span>(x) <span class="kw">scale</span>(x))</span>
<span id="cb7-42"><a href="#cb7-42"></a>      <span class="kw">attributes</span>(x)<span class="op">$</span>info &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">n=</span><span class="kw">nrow</span>(X),<span class="dt">p=</span><span class="kw">ncol</span>(X),<span class="dt">prop=</span><span class="kw">mean</span>(x<span class="op">$</span>Z<span class="op">==</span><span class="dv">0</span>))</span>
<span id="cb7-43"><a href="#cb7-43"></a>    }</span>
<span id="cb7-44"><a href="#cb7-44"></a>    <span class="kw">rm</span>(X)</span>
<span id="cb7-45"><a href="#cb7-45"></a>    </span>
<span id="cb7-46"><a href="#cb7-46"></a>    <span class="co"># cross-validation</span></span>
<span id="cb7-47"><a href="#cb7-47"></a>    loss &lt;-<span class="st"> </span><span class="kw">tryCatch</span>(<span class="dt">expr=</span>palasso<span class="op">:::</span><span class="kw">.predict</span>(<span class="dt">y=</span>y,<span class="dt">X=</span>x,<span class="dt">nfolds.int=</span><span class="dv">10</span>),<span class="dt">error=</span><span class="cf">function</span>(e) palasso<span class="op">:::</span><span class="kw">.predict</span>(<span class="dt">y=</span>y,<span class="dt">X=</span>x,<span class="dt">nfolds.int=</span><span class="dv">10</span>))</span>
<span id="cb7-48"><a href="#cb7-48"></a>    </span>
<span id="cb7-49"><a href="#cb7-49"></a>    <span class="co"># information</span></span>
<span id="cb7-50"><a href="#cb7-50"></a>    loss<span class="op">$</span>info &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">k=</span>k,</span>
<span id="cb7-51"><a href="#cb7-51"></a>                       <span class="dt">y0=</span>comb[<span class="dv">2</span>,k],</span>
<span id="cb7-52"><a href="#cb7-52"></a>                       <span class="dt">y1=</span>comb[<span class="dv">1</span>,k],</span>
<span id="cb7-53"><a href="#cb7-53"></a>                       <span class="dt">n0=</span><span class="kw">sum</span>(y<span class="op">==</span><span class="dv">0</span>),</span>
<span id="cb7-54"><a href="#cb7-54"></a>                       <span class="dt">n1=</span><span class="kw">sum</span>(y<span class="op">==</span><span class="dv">1</span>),</span>
<span id="cb7-55"><a href="#cb7-55"></a>                       <span class="kw">attributes</span>(x)<span class="op">$</span>info,</span>
<span id="cb7-56"><a href="#cb7-56"></a>                       loss<span class="op">$</span>info)</span>
<span id="cb7-57"><a href="#cb7-57"></a>    </span>
<span id="cb7-58"><a href="#cb7-58"></a>    <span class="co"># refit</span></span>
<span id="cb7-59"><a href="#cb7-59"></a>    object &lt;-<span class="st"> </span>palasso<span class="op">::</span><span class="kw">palasso</span>(<span class="dt">y=</span>y,<span class="dt">X=</span>x,<span class="dt">nfolds=</span><span class="dv">10</span>,<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>,<span class="dt">standard=</span><span class="ot">TRUE</span>,<span class="dt">elastic=</span><span class="ot">TRUE</span>,<span class="dt">shrink=</span><span class="ot">TRUE</span>)</span>
<span id="cb7-60"><a href="#cb7-60"></a>    </span>
<span id="cb7-61"><a href="#cb7-61"></a>    model &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">names</span>(object),<span class="st">&quot;elastic&quot;</span>,</span>
<span id="cb7-62"><a href="#cb7-62"></a>               <span class="kw">paste0</span>(<span class="st">&quot;paired.&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;adaptive&quot;</span>,<span class="st">&quot;standard&quot;</span>,<span class="st">&quot;combined&quot;</span>)))</span>
<span id="cb7-63"><a href="#cb7-63"></a>    </span>
<span id="cb7-64"><a href="#cb7-64"></a>    <span class="cf">for</span>(max <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="ot">Inf</span>)){</span>
<span id="cb7-65"><a href="#cb7-65"></a>      temp &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb7-66"><a href="#cb7-66"></a>      temp<span class="op">$</span>nzero &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">model=</span>model,<span class="dt">x=</span><span class="ot">NA</span>,<span class="dt">z=</span><span class="ot">NA</span>)</span>
<span id="cb7-67"><a href="#cb7-67"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(model)){</span>
<span id="cb7-68"><a href="#cb7-68"></a>        coef &lt;-<span class="st"> </span>palasso<span class="op">:::</span><span class="kw">coef.palasso</span>(<span class="dt">object=</span>object,<span class="dt">model=</span>model[i],<span class="dt">max=</span>max)</span>
<span id="cb7-69"><a href="#cb7-69"></a>        temp<span class="op">$</span>nzero<span class="op">$</span>x[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(coef<span class="op">$</span>x<span class="op">!=</span><span class="dv">0</span>)</span>
<span id="cb7-70"><a href="#cb7-70"></a>        temp<span class="op">$</span>nzero<span class="op">$</span>z[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(coef<span class="op">$</span>z<span class="op">!=</span><span class="dv">0</span>)</span>
<span id="cb7-71"><a href="#cb7-71"></a>      }</span>
<span id="cb7-72"><a href="#cb7-72"></a>      temp<span class="op">$</span>select &lt;-<span class="st"> </span>palasso<span class="op">:::</span><span class="kw">subset.palasso</span>(<span class="dt">x=</span>object,<span class="dt">max=</span>max,</span>
<span id="cb7-73"><a href="#cb7-73"></a>                                              <span class="dt">model=</span><span class="st">&quot;paired.adaptive&quot;</span>)<span class="op">$</span>palasso<span class="op">$</span>select</span>
<span id="cb7-74"><a href="#cb7-74"></a>      temp<span class="op">$</span>weights &lt;-<span class="st"> </span>palasso<span class="op">:::</span><span class="kw">weights.palasso</span>(<span class="dt">object=</span>object,<span class="dt">max=</span>max,</span>
<span id="cb7-75"><a href="#cb7-75"></a>                                                <span class="dt">model=</span><span class="st">&quot;paired.adaptive&quot;</span>)</span>
<span id="cb7-76"><a href="#cb7-76"></a>      temp<span class="op">$</span>coef &lt;-<span class="st"> </span>palasso<span class="op">:::</span><span class="kw">coef.palasso</span>(<span class="dt">object=</span>object,<span class="dt">max=</span>max,</span>
<span id="cb7-77"><a href="#cb7-77"></a>                                          <span class="dt">model=</span><span class="st">&quot;paired.adaptive&quot;</span>)</span>
<span id="cb7-78"><a href="#cb7-78"></a>      loss[[<span class="kw">paste0</span>(<span class="st">&quot;fit&quot;</span>,max)]] &lt;-<span class="st"> </span>temp</span>
<span id="cb7-79"><a href="#cb7-79"></a>    }</span>
<span id="cb7-80"><a href="#cb7-80"></a>    </span>
<span id="cb7-81"><a href="#cb7-81"></a>    <span class="kw">save</span>(<span class="dt">object=</span>loss,<span class="dt">file=</span>file1)</span>
<span id="cb7-82"><a href="#cb7-82"></a>    <span class="kw">file.remove</span>(file0)</span>
<span id="cb7-83"><a href="#cb7-83"></a>  }</span>
<span id="cb7-84"><a href="#cb7-84"></a>  </span>
<span id="cb7-85"><a href="#cb7-85"></a>  index &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">grepl</span>(<span class="kw">dir</span>(),<span class="dt">pattern=</span><span class="st">&quot;sessionInfo&quot;</span>))</span>
<span id="cb7-86"><a href="#cb7-86"></a>  <span class="kw">sink</span>(<span class="kw">paste0</span>(<span class="st">&quot;sessionInfo&quot;</span>,index<span class="op">+</span><span class="dv">1</span>,<span class="st">&quot;.txt&quot;</span>))</span>
<span id="cb7-87"><a href="#cb7-87"></a>  <span class="kw">date</span>()</span>
<span id="cb7-88"><a href="#cb7-88"></a>  utils<span class="op">::</span><span class="kw">sessionInfo</span>()</span>
<span id="cb7-89"><a href="#cb7-89"></a>  devtools<span class="op">::</span><span class="kw">session_info</span>()</span>
<span id="cb7-90"><a href="#cb7-90"></a>  <span class="kw">sink</span>()</span>
<span id="cb7-91"><a href="#cb7-91"></a>  </span>
<span id="cb7-92"><a href="#cb7-92"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># The function &lt;&lt;collect&gt;&gt; loads all files from PATH including PATTERN in the file name, loads OBJECT into a list, and executes a function call.</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># path: folder</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co"># pattern: character, or NULL (all files)</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># object: character vector, or NULL (all objects)</span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># what: function call</span></span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a>collect &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">path=</span><span class="kw">getwd</span>(),<span class="dt">pattern=</span><span class="st">&quot;&quot;</span>,<span class="dt">object=</span><span class="ot">NULL</span>,<span class="dt">what=</span><span class="st">&quot;rbind&quot;</span>){</span>
<span id="cb8-10"><a href="#cb8-10"></a>    OBJECT =<span class="st"> </span>object</span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="co"># identify files</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>    files &lt;-<span class="st"> </span><span class="kw">dir</span>(path)</span>
<span id="cb8-13"><a href="#cb8-13"></a>    files &lt;-<span class="st"> </span>files[<span class="kw">grepl</span>(<span class="dt">x=</span>files,<span class="dt">pattern=</span>pattern)]</span>
<span id="cb8-14"><a href="#cb8-14"></a>    files &lt;-<span class="st"> </span>files[<span class="kw">grepl</span>(<span class="dt">x=</span>files,<span class="dt">pattern=</span><span class="st">&quot;.RData&quot;</span>)]</span>
<span id="cb8-15"><a href="#cb8-15"></a>    number &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="dt">pattern=</span><span class="kw">paste0</span>(pattern,<span class="st">&quot;|.RData&quot;</span>),<span class="dt">replacement=</span><span class="st">&quot;&quot;</span>,<span class="dt">x=</span>files)</span>
<span id="cb8-16"><a href="#cb8-16"></a>    files &lt;-<span class="st"> </span>files[<span class="kw">order</span>(<span class="kw">as.numeric</span>(number))] <span class="co"># trial1</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>    names &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="dt">pattern=</span><span class="st">&quot;.RData&quot;</span>,<span class="dt">replacement=</span><span class="st">&quot;&quot;</span>,<span class="dt">x=</span>files) <span class="co"># trial1</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="cf">if</span>(<span class="kw">length</span>(files)<span class="op">==</span><span class="dv">0</span>){<span class="kw">stop</span>(<span class="st">&quot;Invalid datasets.&quot;</span>)}</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="co"># load data</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>    all &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb8-21"><a href="#cb8-21"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(files)){</span>
<span id="cb8-22"><a href="#cb8-22"></a>        x &lt;-<span class="st"> </span><span class="kw">load</span>(<span class="kw">file.path</span>(path,files[i]))</span>
<span id="cb8-23"><a href="#cb8-23"></a>        x &lt;-<span class="st"> </span><span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text=</span>x))</span>
<span id="cb8-24"><a href="#cb8-24"></a>        <span class="cf">if</span>(<span class="kw">is.null</span>(OBJECT)){</span>
<span id="cb8-25"><a href="#cb8-25"></a>            all[[i]] &lt;-<span class="st"> </span>x</span>
<span id="cb8-26"><a href="#cb8-26"></a>            <span class="kw">names</span>(all)[i] &lt;-<span class="st"> </span>names[i] </span>
<span id="cb8-27"><a href="#cb8-27"></a>        } <span class="cf">else</span> {</span>
<span id="cb8-28"><a href="#cb8-28"></a>            <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_along</span>(OBJECT)){</span>
<span id="cb8-29"><a href="#cb8-29"></a>                all[[OBJECT[j]]][[i]] &lt;-<span class="st"> </span>x[[OBJECT[j]]]</span>
<span id="cb8-30"><a href="#cb8-30"></a>                <span class="kw">names</span>(all[[OBJECT[j]]])[i] &lt;-<span class="st"> </span>names[i]</span>
<span id="cb8-31"><a href="#cb8-31"></a>            }</span>
<span id="cb8-32"><a href="#cb8-32"></a>        }</span>
<span id="cb8-33"><a href="#cb8-33"></a>    }</span>
<span id="cb8-34"><a href="#cb8-34"></a>    <span class="co"># fuse data</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>    <span class="cf">if</span>(<span class="kw">is.null</span>(OBJECT)){</span>
<span id="cb8-36"><a href="#cb8-36"></a>        all &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="dt">what=</span>what,<span class="dt">args=</span>all)</span>
<span id="cb8-37"><a href="#cb8-37"></a>    } <span class="cf">else</span> {</span>
<span id="cb8-38"><a href="#cb8-38"></a>        all &lt;-<span class="st"> </span><span class="kw">lapply</span>(all,<span class="cf">function</span>(x) <span class="kw">do.call</span>(<span class="dt">what=</span>what,<span class="dt">args=</span>x))</span>
<span id="cb8-39"><a href="#cb8-39"></a>    }</span>
<span id="cb8-40"><a href="#cb8-40"></a>    <span class="kw">return</span>(all)</span>
<span id="cb8-41"><a href="#cb8-41"></a>}</span>
<span id="cb8-42"><a href="#cb8-42"></a></span>
<span id="cb8-43"><a href="#cb8-43"></a>LOSS &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb8-44"><a href="#cb8-44"></a>type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;CNV&quot;</span>)</span>
<span id="cb8-45"><a href="#cb8-45"></a><span class="co">#type &lt;- &quot;miRNA&quot;</span></span>
<span id="cb8-46"><a href="#cb8-46"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(type)){</span>
<span id="cb8-47"><a href="#cb8-47"></a>  LOSS[[type[i]]] &lt;-<span class="st"> </span><span class="kw">collect</span>(<span class="dt">path=</span><span class="st">&quot;results&quot;</span>,</span>
<span id="cb8-48"><a href="#cb8-48"></a>                             <span class="dt">pattern=</span><span class="kw">paste0</span>(type[i],<span class="st">&quot;_loss_&quot;</span>),</span>
<span id="cb8-49"><a href="#cb8-49"></a>                             <span class="dt">object=</span><span class="kw">c</span>(<span class="st">&quot;deviance&quot;</span>,<span class="st">&quot;auc&quot;</span>,<span class="st">&quot;class&quot;</span>,<span class="st">&quot;info&quot;</span>,</span>
<span id="cb8-50"><a href="#cb8-50"></a>                                      <span class="kw">paste0</span>(<span class="st">&quot;fit&quot;</span>,<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="ot">Inf</span>))))</span>
<span id="cb8-51"><a href="#cb8-51"></a>}</span>
<span id="cb8-52"><a href="#cb8-52"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(LOSS)){</span>
<span id="cb8-53"><a href="#cb8-53"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb8-54"><a href="#cb8-54"></a>    <span class="kw">colnames</span>(LOSS[[i]][[j]])[<span class="kw">colnames</span>(LOSS[[i]][[j]])<span class="op">==</span><span class="st">&quot;paired.adaptive&quot;</span>] &lt;-<span class="st"> &quot;paired&quot;</span></span>
<span id="cb8-55"><a href="#cb8-55"></a>  }</span>
<span id="cb8-56"><a href="#cb8-56"></a>}</span>
<span id="cb8-57"><a href="#cb8-57"></a></span>
<span id="cb8-58"><a href="#cb8-58"></a><span class="co">#type &lt;- &quot;gene&quot;</span></span>
<span id="cb8-59"><a href="#cb8-59"></a><span class="co">#a &lt;- LOSS[[type]]$deviance[rownames(LOSS[[type]]$deviance)==&quot;10&quot;,&quot;paired&quot;]</span></span>
<span id="cb8-60"><a href="#cb8-60"></a><span class="co">#b &lt;- LOSS[[type]]$deviance[rownames(LOSS[[type]]$deviance)==&quot;10&quot;,&quot;elastic&quot;]</span></span>
<span id="cb8-61"><a href="#cb8-61"></a><span class="co">#mean(a&lt;b)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">### Testing for significant differences. </span><span class="al">###</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&lt;&lt;collect&gt;&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a>row &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;CNV&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8"></a>col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;Inf&quot;</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a>lay &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;standard_x&quot;</span>,<span class="st">&quot;standard_z&quot;</span>,<span class="st">&quot;standard_xz&quot;</span>,</span>
<span id="cb9-10"><a href="#cb9-10"></a>         <span class="st">&quot;adaptive_x&quot;</span>,<span class="st">&quot;adaptive_z&quot;</span>,<span class="st">&quot;adaptive_xz&quot;</span>,</span>
<span id="cb9-11"><a href="#cb9-11"></a>         <span class="st">&quot;elastic&quot;</span>) <span class="co"># added &quot;elastic&quot;</span></span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a>M &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>,<span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">length</span>(row),<span class="kw">length</span>(col),<span class="kw">length</span>(lay)),<span class="dt">dimnames=</span><span class="kw">list</span>(row,col,lay))</span>
<span id="cb9-14"><a href="#cb9-14"></a></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(row)){</span>
<span id="cb9-16"><a href="#cb9-16"></a>  </span>
<span id="cb9-17"><a href="#cb9-17"></a>  loss &lt;-<span class="st"> </span>LOSS[[row[i]]][<span class="kw">c</span>(<span class="st">&quot;info&quot;</span>,<span class="st">&quot;deviance&quot;</span>)]</span>
<span id="cb9-18"><a href="#cb9-18"></a>  </span>
<span id="cb9-19"><a href="#cb9-19"></a>  y0 &lt;-<span class="st"> </span><span class="kw">as.character</span>(loss<span class="op">$</span>info<span class="op">$</span>y0)</span>
<span id="cb9-20"><a href="#cb9-20"></a>  y1 &lt;-<span class="st"> </span><span class="kw">as.character</span>(loss<span class="op">$</span>info<span class="op">$</span>y1)</span>
<span id="cb9-21"><a href="#cb9-21"></a>  cancer &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(y0,y1)))</span>
<span id="cb9-22"><a href="#cb9-22"></a>  Z &lt;-<span class="st"> </span>palasso<span class="op">:::</span><span class="kw">.design</span>(<span class="dt">x=</span>cancer)</span>
<span id="cb9-23"><a href="#cb9-23"></a>  </span>
<span id="cb9-24"><a href="#cb9-24"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_along</span>(col)){</span>
<span id="cb9-25"><a href="#cb9-25"></a>    </span>
<span id="cb9-26"><a href="#cb9-26"></a>    <span class="co"># differences</span></span>
<span id="cb9-27"><a href="#cb9-27"></a>    cond &lt;-<span class="st"> </span><span class="kw">rownames</span>(loss<span class="op">$</span>deviance)<span class="op">==</span>col[j]</span>
<span id="cb9-28"><a href="#cb9-28"></a>    </span>
<span id="cb9-29"><a href="#cb9-29"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">seq_along</span>(lay)){</span>
<span id="cb9-30"><a href="#cb9-30"></a>      </span>
<span id="cb9-31"><a href="#cb9-31"></a>      fill &lt;-<span class="st"> </span>loss<span class="op">$</span>deviance[cond,lay[k]] <span class="op">-</span><span class="st"> </span>loss<span class="op">$</span>deviance[cond,<span class="st">&quot;paired&quot;</span>]</span>
<span id="cb9-32"><a href="#cb9-32"></a>      X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="kw">length</span>(cancer),<span class="dt">ncol=</span><span class="kw">length</span>(cancer),</span>
<span id="cb9-33"><a href="#cb9-33"></a>                  <span class="dt">dimnames=</span><span class="kw">list</span>(cancer,cancer))</span>
<span id="cb9-34"><a href="#cb9-34"></a>      X[<span class="kw">cbind</span>(y0,y1)] &lt;-<span class="st"> </span>X[<span class="kw">cbind</span>(y1,y0)] &lt;-<span class="st"> </span>fill</span>
<span id="cb9-35"><a href="#cb9-35"></a>      X[<span class="kw">lower.tri</span>(X)] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb9-36"><a href="#cb9-36"></a>      </span>
<span id="cb9-37"><a href="#cb9-37"></a>      <span class="co"># p-values</span></span>
<span id="cb9-38"><a href="#cb9-38"></a>      pvalue &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="dt">times=</span><span class="kw">max</span>(Z))</span>
<span id="cb9-39"><a href="#cb9-39"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="kw">max</span>(Z))){</span>
<span id="cb9-40"><a href="#cb9-40"></a>        x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(X[Z<span class="op">==</span>l])</span>
<span id="cb9-41"><a href="#cb9-41"></a>        <span class="cf">if</span>(col[j]<span class="op">==</span><span class="st">&quot;10&quot;</span>){</span>
<span id="cb9-42"><a href="#cb9-42"></a>          alternative &lt;-<span class="st"> &quot;greater&quot;</span> <span class="co"># Never use &quot;two.sided&quot;!</span></span>
<span id="cb9-43"><a href="#cb9-43"></a>        }</span>
<span id="cb9-44"><a href="#cb9-44"></a>        <span class="cf">if</span>(col[j]<span class="op">==</span><span class="st">&quot;Inf&quot;</span>){</span>
<span id="cb9-45"><a href="#cb9-45"></a>          alternative &lt;-<span class="st"> &quot;less&quot;</span> <span class="co"># Never use &quot;two.sided&quot;!</span></span>
<span id="cb9-46"><a href="#cb9-46"></a>        }</span>
<span id="cb9-47"><a href="#cb9-47"></a>        pvalue[l] &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">wilcox.test</span>(<span class="dt">x=</span>x,<span class="dt">alternative=</span>alternative,</span>
<span id="cb9-48"><a href="#cb9-48"></a>                                 <span class="dt">exact=</span><span class="ot">FALSE</span>)<span class="op">$</span>p.value</span>
<span id="cb9-49"><a href="#cb9-49"></a>      }</span>
<span id="cb9-50"><a href="#cb9-50"></a>      </span>
<span id="cb9-51"><a href="#cb9-51"></a>      <span class="co"># Simes</span></span>
<span id="cb9-52"><a href="#cb9-52"></a>      M[i,j,k] &lt;-<span class="st"> </span>palasso<span class="op">:::</span><span class="kw">.combine</span>(pvalue,<span class="dt">method=</span><span class="st">&quot;simes&quot;</span>)</span>
<span id="cb9-53"><a href="#cb9-53"></a>    }</span>
<span id="cb9-54"><a href="#cb9-54"></a>  }</span>
<span id="cb9-55"><a href="#cb9-55"></a>}</span>
<span id="cb9-56"><a href="#cb9-56"></a></span>
<span id="cb9-57"><a href="#cb9-57"></a><span class="co"># Table SIG: significance</span></span>
<span id="cb9-58"><a href="#cb9-58"></a>constraint &lt;-<span class="st"> &quot;10&quot;</span></span>
<span id="cb9-59"><a href="#cb9-59"></a>table &lt;-<span class="st"> </span><span class="kw">format</span>(M[,constraint,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>],<span class="dt">digits=</span><span class="dv">1</span>,<span class="dt">scientific=</span><span class="ot">FALSE</span>)</span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="kw">nrow</span>(table))){</span>
<span id="cb9-61"><a href="#cb9-61"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="kw">ncol</span>(table))){</span>
<span id="cb9-62"><a href="#cb9-62"></a>        <span class="cf">if</span>(M[i,constraint,j]<span class="op">&gt;=</span><span class="fl">0.05</span>){</span>
<span id="cb9-63"><a href="#cb9-63"></a>            table[i,j] &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;{</span><span class="ch">\\</span><span class="st">color{gray}{&quot;</span>,table[i,j],<span class="st">&quot;}}&quot;</span>)</span>
<span id="cb9-64"><a href="#cb9-64"></a>        }</span>
<span id="cb9-65"><a href="#cb9-65"></a>    }</span>
<span id="cb9-66"><a href="#cb9-66"></a>}</span>
<span id="cb9-67"><a href="#cb9-67"></a>one &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{standard}&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{adaptive}&quot;</span>,<span class="st">&quot;&quot;</span>)</span>
<span id="cb9-68"><a href="#cb9-68"></a>two &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>),<span class="st">&quot;}&quot;</span>)</span>
<span id="cb9-69"><a href="#cb9-69"></a><span class="kw">rownames</span>(table) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{&quot;</span>,<span class="kw">rownames</span>(table),<span class="st">&quot;}&quot;</span>)</span>
<span id="cb9-70"><a href="#cb9-70"></a>table &lt;-<span class="st"> </span><span class="kw">rbind</span>(one,two,table,<span class="dt">deparse.level=</span><span class="dv">0</span>)</span>
<span id="cb9-71"><a href="#cb9-71"></a><span class="kw">rownames</span>(table)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;~&quot;</span></span>
<span id="cb9-72"><a href="#cb9-72"></a>xtable &lt;-<span class="st"> </span>xtable<span class="op">::</span><span class="kw">xtable</span>(table,<span class="dt">align=</span><span class="kw">c</span>(<span class="st">&quot;r&quot;</span>,<span class="st">&quot;|&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;|&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb9-73"><a href="#cb9-73"></a>xtable<span class="op">::</span><span class="kw">print.xtable</span>(xtable,<span class="dt">type=</span><span class="st">&quot;latex&quot;</span>,<span class="dt">include.colnames=</span><span class="ot">FALSE</span>,<span class="dt">sanitize.text.function=</span>identity)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">### Comparison with elastic net. </span><span class="al">###</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&lt;&lt;collect&gt;&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a>row &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;CNV&quot;</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a>col &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;10&quot;</span>,<span class="st">&quot;50&quot;</span>,<span class="st">&quot;Inf&quot;</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a>better &lt;-<span class="st"> </span>worse &lt;-<span class="st"> </span>less &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="kw">length</span>(row),<span class="dt">ncol=</span><span class="kw">length</span>(col),</span>
<span id="cb10-9"><a href="#cb10-9"></a>                 <span class="dt">dimnames=</span><span class="kw">list</span>(row,col))</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(row)){</span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_along</span>(col)){</span>
<span id="cb10-12"><a href="#cb10-12"></a>    <span class="co"># proportion of improvements (cross-validation)</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>    cond &lt;-<span class="st"> </span><span class="kw">rownames</span>(LOSS[[row[i]]]<span class="op">$</span>deviance)<span class="op">==</span>col[j]</span>
<span id="cb10-14"><a href="#cb10-14"></a>    loss &lt;-<span class="st"> </span>LOSS[[row[i]]]<span class="op">$</span>deviance[cond,<span class="kw">c</span>(<span class="st">&quot;paired&quot;</span>,<span class="st">&quot;elastic&quot;</span>)]</span>
<span id="cb10-15"><a href="#cb10-15"></a>    better[i,j] &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(loss[,<span class="st">&quot;paired&quot;</span>]<span class="op">&lt;</span>loss[,<span class="st">&quot;elastic&quot;</span>]),<span class="dt">digits=</span><span class="dv">2</span>)</span>
<span id="cb10-16"><a href="#cb10-16"></a>    worse[i,j] &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(loss[,<span class="st">&quot;paired&quot;</span>]<span class="op">&gt;</span>loss[,<span class="st">&quot;elastic&quot;</span>]),<span class="dt">digits=</span><span class="dv">2</span>)</span>
<span id="cb10-17"><a href="#cb10-17"></a>    <span class="co"># average difference in nzero (refitted models)</span></span>
<span id="cb10-18"><a href="#cb10-18"></a>    df_paired &lt;-<span class="st"> </span><span class="kw">apply</span>(LOSS[[row[i]]][[<span class="kw">paste0</span>(<span class="st">&quot;fit&quot;</span>,col[j])]],<span class="dv">1</span>,<span class="cf">function</span>(x)   <span class="kw">sum</span>(x<span class="op">$</span>nzero[x<span class="op">$</span>nzero[,<span class="st">&quot;model&quot;</span>]<span class="op">==</span><span class="st">&quot;paired.adaptive&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>)]))</span>
<span id="cb10-19"><a href="#cb10-19"></a>    df_elastic &lt;-<span class="st"> </span><span class="kw">apply</span>(LOSS[[row[i]]][[<span class="kw">paste0</span>(<span class="st">&quot;fit&quot;</span>,col[j])]],<span class="dv">1</span>,<span class="cf">function</span>(x)   <span class="kw">sum</span>(x<span class="op">$</span>nzero[x<span class="op">$</span>nzero[,<span class="st">&quot;model&quot;</span>]<span class="op">==</span><span class="st">&quot;elastic95&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>)]))</span>
<span id="cb10-20"><a href="#cb10-20"></a>    df_diff &lt;-<span class="st"> </span>df_elastic<span class="op">-</span>df_paired</span>
<span id="cb10-21"><a href="#cb10-21"></a>    less[i,j] &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(df_diff),<span class="dt">digits=</span><span class="dv">2</span>)</span>
<span id="cb10-22"><a href="#cb10-22"></a>    <span class="co">#graphics::hist(df_diff,main=paste(row[i],col[j]),xlim=c(-1,1)*max(abs(df_diff)))</span></span>
<span id="cb10-23"><a href="#cb10-23"></a>  }</span>
<span id="cb10-24"><a href="#cb10-24"></a>}</span>
<span id="cb10-25"><a href="#cb10-25"></a>better</span>
<span id="cb10-26"><a href="#cb10-26"></a>worse</span>
<span id="cb10-27"><a href="#cb10-27"></a>less</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">### Analysing the refitted models. </span><span class="al">###</span></span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&lt;&lt;collect&gt;&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co"># Table SEL: selected model</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>nzero &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;fit&quot;</span>,<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="ot">Inf</span>))</span>
<span id="cb11-9"><a href="#cb11-9"></a>model &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;standard_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),</span>
<span id="cb11-10"><a href="#cb11-10"></a>           <span class="kw">paste0</span>(<span class="st">&quot;adaptive_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),</span>
<span id="cb11-11"><a href="#cb11-11"></a>           <span class="st">&quot;between_xz&quot;</span>,<span class="st">&quot;within_xz&quot;</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a>type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;CNV&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a>table &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>,<span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">length</span>(nzero),<span class="kw">length</span>(model),<span class="kw">length</span>(type)),</span>
<span id="cb11-14"><a href="#cb11-14"></a>               <span class="dt">dimnames=</span><span class="kw">list</span>(nzero,model,type))</span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(nzero)){</span>
<span id="cb11-16"><a href="#cb11-16"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_along</span>(model)){</span>
<span id="cb11-17"><a href="#cb11-17"></a>        <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">seq_along</span>(type)){</span>
<span id="cb11-18"><a href="#cb11-18"></a>            sub &lt;-<span class="st"> </span>LOSS[[type[k]]][[nzero[i]]]</span>
<span id="cb11-19"><a href="#cb11-19"></a>            table[i,j,k] &lt;-<span class="st"> </span><span class="kw">sum</span>(sub[,<span class="st">&quot;select&quot;</span>]<span class="op">==</span>model[j])</span>
<span id="cb11-20"><a href="#cb11-20"></a>        }</span>
<span id="cb11-21"><a href="#cb11-21"></a>    }</span>
<span id="cb11-22"><a href="#cb11-22"></a>}</span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="kw">colSums</span>(table[<span class="st">&quot;fit10&quot;</span>,,]) <span class="co"># CHECK WHETHER COMPLETE!</span></span>
<span id="cb11-24"><a href="#cb11-24"></a>table &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">prop.table</span>(table[<span class="st">&quot;fit10&quot;</span>,,],<span class="dt">margin=</span><span class="dv">2</span>),<span class="dt">digits=</span><span class="dv">2</span>)</span>
<span id="cb11-25"><a href="#cb11-25"></a>table &lt;-<span class="st"> </span><span class="kw">t</span>(table)</span>
<span id="cb11-26"><a href="#cb11-26"></a>table &lt;-<span class="st"> </span>table[,<span class="kw">apply</span>(table,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">any</span>(x<span class="op">!=</span><span class="dv">0</span>))]</span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="kw">rownames</span>(table) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{&quot;</span>,<span class="kw">rownames</span>(table),<span class="st">&quot;}&quot;</span>)</span>
<span id="cb11-28"><a href="#cb11-28"></a>xtable &lt;-<span class="st"> </span>xtable<span class="op">::</span><span class="kw">xtable</span>(table,<span class="dt">align=</span><span class="kw">c</span>(<span class="st">&quot;r&quot;</span>,<span class="st">&quot;|&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb11-29"><a href="#cb11-29"></a>xtable<span class="op">::</span><span class="kw">print.xtable</span>(xtable,<span class="dt">type=</span><span class="st">&quot;latex&quot;</span>,<span class="dt">include.colnames=</span><span class="ot">FALSE</span>,<span class="dt">sanitize.text.function=</span>identity)</span>
<span id="cb11-30"><a href="#cb11-30"></a></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co"># selected weights and covariates</span></span>
<span id="cb11-32"><a href="#cb11-32"></a>type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;CNV&quot;</span>)</span>
<span id="cb11-33"><a href="#cb11-33"></a>group &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>)</span>
<span id="cb11-34"><a href="#cb11-34"></a>model &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;standard_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),</span>
<span id="cb11-35"><a href="#cb11-35"></a>           <span class="kw">paste0</span>(<span class="st">&quot;adaptive_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),</span>
<span id="cb11-36"><a href="#cb11-36"></a>           <span class="st">&quot;paired.adaptive&quot;</span>,<span class="st">&quot;elastic&quot;</span>) <span class="co"># added &quot;elastic&quot; , paste0(&quot;elastic&quot;,c(100,75,50,25))</span></span>
<span id="cb11-37"><a href="#cb11-37"></a>weights10 &lt;-<span class="st"> </span>weightsInf &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="kw">length</span>(group),<span class="dt">ncol=</span><span class="kw">length</span>(type),</span>
<span id="cb11-38"><a href="#cb11-38"></a>                <span class="dt">dimnames=</span><span class="kw">list</span>(group,type))</span>
<span id="cb11-39"><a href="#cb11-39"></a>coef10 &lt;-<span class="st"> </span>coefInf &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>,<span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">length</span>(group),<span class="kw">length</span>(type),<span class="kw">length</span>(model)),</span>
<span id="cb11-40"><a href="#cb11-40"></a>               <span class="dt">dimnames=</span><span class="kw">list</span>(group,type,model))</span>
<span id="cb11-41"><a href="#cb11-41"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(group)){</span>
<span id="cb11-42"><a href="#cb11-42"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="kw">seq_along</span>(type)){</span>
<span id="cb11-43"><a href="#cb11-43"></a>        weights10[,j] &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(<span class="kw">sapply</span>(LOSS[[type[j]]]<span class="op">$</span>fit10[,<span class="st">&quot;weights&quot;</span>],colMeans))</span>
<span id="cb11-44"><a href="#cb11-44"></a>        weightsInf[,j] &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(<span class="kw">sapply</span>(LOSS[[type[j]]]<span class="op">$</span>fitInf[,<span class="st">&quot;weights&quot;</span>],colMeans))</span>
<span id="cb11-45"><a href="#cb11-45"></a>        <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">seq_along</span>(model)){</span>
<span id="cb11-46"><a href="#cb11-46"></a>            coef10[i,j,k] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sapply</span>(LOSS[[type[j]]]<span class="op">$</span>fit10[,<span class="st">&quot;nzero&quot;</span>], <span class="cf">function</span>(x) <span class="kw">sum</span>(x[x<span class="op">$</span>model<span class="op">==</span>model[k],group[i]])))</span>
<span id="cb11-47"><a href="#cb11-47"></a>            coefInf[i,j,k] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sapply</span>(LOSS[[type[j]]]<span class="op">$</span>fitInf[,<span class="st">&quot;nzero&quot;</span>], <span class="cf">function</span>(x) <span class="kw">sum</span>(x[x<span class="op">$</span>model<span class="op">==</span>model[k],group[i]])))</span>
<span id="cb11-48"><a href="#cb11-48"></a>        }</span>
<span id="cb11-49"><a href="#cb11-49"></a>    }</span>
<span id="cb11-50"><a href="#cb11-50"></a>}</span>
<span id="cb11-51"><a href="#cb11-51"></a><span class="co"># coef10[&quot;x&quot;,,]+coef10[&quot;z&quot;,,]</span></span>
<span id="cb11-52"><a href="#cb11-52"></a></span>
<span id="cb11-53"><a href="#cb11-53"></a></span>
<span id="cb11-54"><a href="#cb11-54"></a><span class="co"># with sparsity constraint</span></span>
<span id="cb11-55"><a href="#cb11-55"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(weights10,<span class="dt">margin=</span><span class="dv">2</span>),<span class="dv">2</span>)</span>
<span id="cb11-56"><a href="#cb11-56"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(coef10[,,<span class="st">&quot;paired.adaptive&quot;</span>],<span class="dt">margin=</span><span class="dv">2</span>),<span class="dv">2</span>)</span>
<span id="cb11-57"><a href="#cb11-57"></a><span class="kw">round</span>(<span class="kw">colSums</span>(coef10[,,<span class="st">&quot;paired.adaptive&quot;</span>]),<span class="dv">2</span>)</span>
<span id="cb11-58"><a href="#cb11-58"></a></span>
<span id="cb11-59"><a href="#cb11-59"></a><span class="co"># natural sparsity</span></span>
<span id="cb11-60"><a href="#cb11-60"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(weightsInf,<span class="dt">margin=</span><span class="dv">2</span>),<span class="dv">2</span>)</span>
<span id="cb11-61"><a href="#cb11-61"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(coefInf[,,<span class="st">&quot;paired.adaptive&quot;</span>],<span class="dt">margin=</span><span class="dv">2</span>),<span class="dv">2</span>)</span>
<span id="cb11-62"><a href="#cb11-62"></a><span class="kw">round</span>(<span class="kw">colSums</span>(coefInf[,,<span class="st">&quot;paired.adaptive&quot;</span>]),<span class="dv">2</span>)</span>
<span id="cb11-63"><a href="#cb11-63"></a><span class="kw">round</span>(<span class="kw">colSums</span>(coefInf[,,<span class="st">&quot;elastic&quot;</span>])<span class="op">/</span><span class="kw">colSums</span>(coefInf[,,<span class="st">&quot;paired.adaptive&quot;</span>]),<span class="dv">1</span>) <span class="co"># multiple nzero of elastic net and paired lasso</span></span>
<span id="cb11-64"><a href="#cb11-64"></a></span>
<span id="cb11-65"><a href="#cb11-65"></a><span class="co"># Table NSC: number of non-zero coefficients</span></span>
<span id="cb11-66"><a href="#cb11-66"></a>table &lt;-<span class="st"> </span><span class="kw">round</span>(coefInf[<span class="st">&quot;x&quot;</span>,,]<span class="op">+</span>coefInf[<span class="st">&quot;z&quot;</span>,,])</span>
<span id="cb11-67"><a href="#cb11-67"></a><span class="kw">colnames</span>(table)[<span class="dv">7</span>] &lt;-<span class="st"> &quot;paired&quot;</span></span>
<span id="cb11-68"><a href="#cb11-68"></a>one &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{standard}&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{adaptive}&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{paired}&quot;</span>,<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{elastic}&quot;</span>)</span>
<span id="cb11-69"><a href="#cb11-69"></a>two &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>,<span class="st">&quot;xz&quot;</span>,<span class="st">&quot;xz&quot;</span>),<span class="st">&quot;}&quot;</span>)</span>
<span id="cb11-70"><a href="#cb11-70"></a><span class="kw">rownames</span>(table) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">text{&quot;</span>,<span class="kw">rownames</span>(table),<span class="st">&quot;}&quot;</span>)</span>
<span id="cb11-71"><a href="#cb11-71"></a>table &lt;-<span class="st"> </span><span class="kw">rbind</span>(one,two,table,<span class="dt">deparse.level=</span><span class="dv">0</span>)</span>
<span id="cb11-72"><a href="#cb11-72"></a><span class="kw">rownames</span>(table)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;~&quot;</span></span>
<span id="cb11-73"><a href="#cb11-73"></a>xtable &lt;-<span class="st"> </span>xtable<span class="op">::</span><span class="kw">xtable</span>(table,<span class="dt">align=</span><span class="kw">c</span>(<span class="st">&quot;r&quot;</span>,<span class="st">&quot;|&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;|&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;|&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;|&quot;</span>,<span class="st">&quot;c&quot;</span>))</span>
<span id="cb11-74"><a href="#cb11-74"></a>xtable<span class="op">::</span><span class="kw">print.xtable</span>(xtable,<span class="dt">type=</span><span class="st">&quot;latex&quot;</span>,<span class="dt">include.colnames=</span><span class="ot">FALSE</span>,<span class="dt">sanitize.text.function=</span>identity)</span></code></pre></div>
</div>
<div id="figures" class="section level1">
<h1>Figures</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">### FIGURE CSW </span><span class="al">###</span></span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>overfit &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co"># simulate</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>n &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>cx &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">rbeta</span>(<span class="dt">n=</span>n,<span class="dt">shape1=</span><span class="fl">0.9</span>,<span class="dt">shape2=</span><span class="dv">1</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a>cz &lt;-<span class="st"> </span>stats<span class="op">::</span><span class="kw">rbeta</span>(<span class="dt">n=</span>n,<span class="dt">shape1=</span><span class="fl">0.4</span>,<span class="dt">shape2=</span><span class="fl">0.9</span>)</span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co"># collection</span></span>
<span id="cb12-15"><a href="#cb12-15"></a>x &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb12-16"><a href="#cb12-16"></a>y &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb12-17"><a href="#cb12-17"></a></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co"># adaptive weights (X only)</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>x[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="dt">times=</span>n)</span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="cf">if</span>(overfit){x[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>cx}</span>
<span id="cb12-21"><a href="#cb12-21"></a>y[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dt">times=</span>n)</span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co"># adaptive weights (Z only)</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>x[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dt">times=</span>n)</span>
<span id="cb12-25"><a href="#cb12-25"></a>y[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="dt">times=</span>n)</span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="cf">if</span>(overfit){y[[<span class="dv">2</span>]] &lt;-<span class="st"> </span>cz}</span>
<span id="cb12-27"><a href="#cb12-27"></a></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="co"># adaptive weights (X and Z)</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>x[[<span class="dv">3</span>]] &lt;-<span class="st"> </span>y[[<span class="dv">3</span>]] &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.5</span>,<span class="dt">times=</span>n)</span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="cf">if</span>(overfit){x[[<span class="dv">3</span>]] &lt;-<span class="st"> </span>cx}</span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="cf">if</span>(overfit){y[[<span class="dv">3</span>]] &lt;-<span class="st"> </span>cz}</span>
<span id="cb12-32"><a href="#cb12-32"></a></span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="co"># within-pair weights</span></span>
<span id="cb12-34"><a href="#cb12-34"></a>x[[<span class="dv">4</span>]] &lt;-<span class="st"> </span>cx<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(cx<span class="op">+</span>cz)</span>
<span id="cb12-35"><a href="#cb12-35"></a>y[[<span class="dv">4</span>]] &lt;-<span class="st"> </span>cz<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(cx<span class="op">+</span>cz)</span>
<span id="cb12-36"><a href="#cb12-36"></a></span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="co"># visualisation</span></span>
<span id="cb12-38"><a href="#cb12-38"></a>graphics<span class="op">::</span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">4.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb12-39"><a href="#cb12-39"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_len</span>(<span class="dv">4</span>)){</span>
<span id="cb12-40"><a href="#cb12-40"></a>    palasso<span class="op">:::</span><span class="kw">plot_pairs</span>(<span class="dt">x=</span>x[[i]],<span class="dt">y=</span>y[[i]],<span class="dt">lwd=</span><span class="dv">4</span>)</span>
<span id="cb12-41"><a href="#cb12-41"></a>    <span class="cf">if</span>(i<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb12-42"><a href="#cb12-42"></a>        graphics<span class="op">::</span><span class="kw">mtext</span>(<span class="dt">text=</span><span class="st">&quot;covariate pair&quot;</span>,<span class="dt">side=</span><span class="dv">2</span>,<span class="dt">line=</span><span class="dv">1</span>)</span>
<span id="cb12-43"><a href="#cb12-43"></a>    }</span>
<span id="cb12-44"><a href="#cb12-44"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">### FIGURE DIA </span><span class="al">###</span></span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>ellipse &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">a=</span><span class="fl">0.2</span>,<span class="dt">b=</span><span class="fl">0.25</span>,<span class="dt">border=</span><span class="ot">NA</span>){</span>
<span id="cb13-7"><a href="#cb13-7"></a>    n &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">c</span>(<span class="kw">length</span>(x),<span class="kw">length</span>(y)))</span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="cf">if</span>(<span class="kw">length</span>(x)<span class="op">==</span><span class="dv">1</span>){x &lt;-<span class="st"> </span><span class="kw">rep</span>(x,<span class="dt">times=</span>n)}</span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="cf">if</span>(<span class="kw">length</span>(y)<span class="op">==</span><span class="dv">1</span>){y &lt;-<span class="st"> </span><span class="kw">rep</span>(y,<span class="dt">times=</span>n)}</span>
<span id="cb13-10"><a href="#cb13-10"></a>    <span class="cf">if</span>(<span class="kw">length</span>(border)<span class="op">==</span><span class="dv">1</span>){border &lt;-<span class="st"> </span><span class="kw">rep</span>(border,<span class="dt">times=</span>n)}</span>
<span id="cb13-11"><a href="#cb13-11"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_len</span>(n)){</span>
<span id="cb13-12"><a href="#cb13-12"></a>        angle &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>,<span class="dt">to=</span><span class="dv">2</span><span class="op">*</span>pi,<span class="dt">length=</span><span class="dv">100</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a>        xs &lt;-<span class="st"> </span>x[i] <span class="op">+</span><span class="st"> </span>a <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(angle)</span>
<span id="cb13-14"><a href="#cb13-14"></a>        ys &lt;-<span class="st"> </span>y[i] <span class="op">+</span><span class="st"> </span>b <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(angle)</span>
<span id="cb13-15"><a href="#cb13-15"></a>        graphics<span class="op">::</span><span class="kw">polygon</span>(<span class="dt">x=</span>xs,<span class="dt">y=</span>ys,<span class="dt">col=</span><span class="kw">grey</span>(<span class="fl">0.9</span>),<span class="dt">border=</span>border[i])</span>
<span id="cb13-16"><a href="#cb13-16"></a>    }</span>
<span id="cb13-17"><a href="#cb13-17"></a>}</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a>cancer &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ACC&quot;</span>,<span class="st">&quot;BLCA&quot;</span>,<span class="st">&quot;BRCA&quot;</span>,<span class="st">&quot;UVM&quot;</span>)</span>
<span id="cb13-20"><a href="#cb13-20"></a>number &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">80</span>,<span class="dv">409</span>,<span class="dv">1078</span>,<span class="dv">80</span>)</span>
<span id="cb13-21"><a href="#cb13-21"></a>col &lt;-<span class="st"> </span>grDevices<span class="op">::</span><span class="kw">rgb</span>(<span class="dt">red=</span><span class="dv">0</span>,<span class="dt">green=</span><span class="dv">0</span>,<span class="dt">blue=</span><span class="kw">sample</span>(<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">75</span>,<span class="dt">to=</span><span class="dv">255</span>,<span class="dt">length.out=</span><span class="kw">length</span>(number))),<span class="dt">maxColorValue=</span><span class="dv">255</span>)</span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a>lwd &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>number)<span class="op">-</span><span class="dv">2</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>lwd =<span class="st"> </span><span class="kw">pmax</span>(<span class="dv">5</span><span class="op">*</span>number<span class="op">/</span><span class="kw">max</span>(number),<span class="dv">1</span>)</span>
<span id="cb13-25"><a href="#cb13-25"></a>x1 &lt;-<span class="st"> </span><span class="fl">1.3</span>; x2 &lt;-<span class="st"> </span><span class="dv">2</span>; x3 &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb13-26"><a href="#cb13-26"></a></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb13-28"><a href="#cb13-28"></a></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="co"># first layer (bubble)</span></span>
<span id="cb13-30"><a href="#cb13-30"></a>graphics<span class="op">::</span><span class="kw">plot.new</span>()</span>
<span id="cb13-31"><a href="#cb13-31"></a>graphics<span class="op">::</span><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb13-32"><a href="#cb13-32"></a>graphics<span class="op">::</span><span class="kw">plot.window</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="fl">1.1</span>,<span class="fl">3.3</span>),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.6</span>,<span class="fl">1.6</span>))</span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="kw">ellipse</span>(<span class="dt">x=</span>x1,<span class="dt">y=</span><span class="dv">0</span>)</span>
<span id="cb13-34"><a href="#cb13-34"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x1,<span class="dt">y=</span><span class="dv">0</span>,<span class="dt">labels=</span><span class="st">&quot;TCGA&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb13-35"><a href="#cb13-35"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x1,<span class="dt">y=</span><span class="dv">0</span>,<span class="dt">labels=</span><span class="st">&quot;n=9794&quot;</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">1.2</span>),<span class="dt">cex=</span><span class="fl">0.9</span>)</span>
<span id="cb13-36"><a href="#cb13-36"></a></span>
<span id="cb13-37"><a href="#cb13-37"></a><span class="co"># second layer (colon)</span></span>
<span id="cb13-38"><a href="#cb13-38"></a>y1 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">1</span>,<span class="dt">to=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">length.out=</span><span class="kw">length</span>(cancer)<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb13-39"><a href="#cb13-39"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x2,<span class="dt">y=</span>y1[<span class="kw">length</span>(cancer)],<span class="dt">labels=</span><span class="st">&quot;...&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>,<span class="dt">srt=</span><span class="dv">90</span>)</span>
<span id="cb13-40"><a href="#cb13-40"></a>y1 &lt;-<span class="st"> </span>y1[<span class="op">-</span><span class="kw">length</span>(cancer)]</span>
<span id="cb13-41"><a href="#cb13-41"></a></span>
<span id="cb13-42"><a href="#cb13-42"></a><span class="co"># first-second layer (connect)</span></span>
<span id="cb13-43"><a href="#cb13-43"></a>graphics<span class="op">::</span><span class="kw">segments</span>(<span class="dt">x0=</span>x1<span class="fl">+0.2</span>,<span class="dt">y0=</span><span class="dv">0</span>,<span class="dt">x1=</span>x2<span class="fl">-0.2</span>,<span class="dt">y1=</span>y1,<span class="dt">lwd=</span>lwd,<span class="dt">col=</span>col)</span>
<span id="cb13-44"><a href="#cb13-44"></a></span>
<span id="cb13-45"><a href="#cb13-45"></a><span class="co"># second layer (bubble)</span></span>
<span id="cb13-46"><a href="#cb13-46"></a><span class="kw">ellipse</span>(<span class="dt">x=</span>x2,<span class="dt">y=</span>y1,<span class="dt">a=</span><span class="fl">0.2</span>,<span class="dt">b=</span><span class="fl">0.2</span>)</span>
<span id="cb13-47"><a href="#cb13-47"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x2,<span class="dt">y=</span>y1,<span class="dt">labels=</span>cancer,<span class="dt">font=</span><span class="dv">2</span>,<span class="dt">col=</span>col,<span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb13-48"><a href="#cb13-48"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x2,<span class="dt">y=</span>y1,<span class="dt">labels=</span><span class="kw">paste0</span>(<span class="st">&quot;n=&quot;</span>,number,<span class="st">&quot;&quot;</span>),<span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">1.2</span>),<span class="dt">cex=</span><span class="fl">0.9</span>)</span>
<span id="cb13-49"><a href="#cb13-49"></a></span>
<span id="cb13-50"><a href="#cb13-50"></a>comb &lt;-<span class="st"> </span>utils<span class="op">::</span><span class="kw">combn</span>(<span class="dt">x=</span><span class="kw">seq_along</span>(y1),<span class="dt">m=</span><span class="dv">2</span>)</span>
<span id="cb13-51"><a href="#cb13-51"></a></span>
<span id="cb13-52"><a href="#cb13-52"></a><span class="co"># third layer (colon)</span></span>
<span id="cb13-53"><a href="#cb13-53"></a>y2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="fl">1.5</span>,<span class="dt">to=</span><span class="op">-</span><span class="fl">1.5</span>,<span class="dt">length.out=</span><span class="kw">ncol</span>(comb)<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb13-54"><a href="#cb13-54"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y2[<span class="kw">ncol</span>(comb)],<span class="dt">labels=</span><span class="st">&quot;...&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>,<span class="dt">srt=</span><span class="dv">90</span>)</span>
<span id="cb13-55"><a href="#cb13-55"></a>y2 &lt;-<span class="st"> </span>y2[<span class="op">-</span><span class="kw">ncol</span>(comb)]</span>
<span id="cb13-56"><a href="#cb13-56"></a></span>
<span id="cb13-57"><a href="#cb13-57"></a><span class="co"># second-third layer (connect)</span></span>
<span id="cb13-58"><a href="#cb13-58"></a>graphics<span class="op">::</span><span class="kw">segments</span>(<span class="dt">x0=</span><span class="fl">2.2</span>,<span class="dt">y0=</span>y1[comb[<span class="dv">1</span>,]],<span class="dt">x1=</span><span class="fl">2.7</span>,<span class="dt">y1=</span>y2,<span class="dt">lwd=</span>lwd[comb[<span class="dv">1</span>,]],<span class="dt">col=</span>col[comb[<span class="dv">1</span>,]])</span>
<span id="cb13-59"><a href="#cb13-59"></a>graphics<span class="op">::</span><span class="kw">segments</span>(<span class="dt">x0=</span><span class="fl">2.2</span>,<span class="dt">y0=</span>y1[comb[<span class="dv">2</span>,]],<span class="dt">x1=</span><span class="fl">2.7</span>,<span class="dt">y1=</span>y2,<span class="dt">lwd=</span>lwd[comb[<span class="dv">2</span>,]],<span class="dt">col=</span>col[comb[<span class="dv">2</span>,]])</span>
<span id="cb13-60"><a href="#cb13-60"></a></span>
<span id="cb13-61"><a href="#cb13-61"></a><span class="co"># third layer (bubble)</span></span>
<span id="cb13-62"><a href="#cb13-62"></a><span class="kw">ellipse</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y2,<span class="dt">a=</span><span class="fl">0.3</span>,<span class="dt">b=</span><span class="fl">0.22</span>)</span>
<span id="cb13-63"><a href="#cb13-63"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y2,<span class="dt">labels=</span><span class="kw">paste0</span>(cancer[comb[<span class="dv">1</span>,]],<span class="st">&quot; &quot;</span>),</span>
<span id="cb13-64"><a href="#cb13-64"></a>               <span class="dt">font=</span><span class="dv">2</span>,<span class="dt">col=</span>col[comb[<span class="dv">1</span>,]],<span class="dt">adj=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb13-65"><a href="#cb13-65"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y2,<span class="dt">labels=</span><span class="kw">paste0</span>(<span class="st">&quot; &quot;</span>,cancer[comb[<span class="dv">2</span>,]]),</span>
<span id="cb13-66"><a href="#cb13-66"></a>               <span class="dt">font=</span><span class="dv">2</span>,<span class="dt">col=</span>col[comb[<span class="dv">2</span>,]],<span class="dt">adj=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb13-67"><a href="#cb13-67"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y2,<span class="dt">labels=</span><span class="st">&quot;:&quot;</span>,<span class="dt">font=</span><span class="dv">2</span>,<span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">0</span>))</span>
<span id="cb13-68"><a href="#cb13-68"></a>labels &lt;-<span class="st"> </span><span class="kw">apply</span>(comb,<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="kw">sum</span>(number[x]))</span>
<span id="cb13-69"><a href="#cb13-69"></a>labels &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;n=&quot;</span>,labels,<span class="st">&quot;&quot;</span>)</span>
<span id="cb13-70"><a href="#cb13-70"></a>graphics<span class="op">::</span><span class="kw">text</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y2,<span class="dt">labels=</span>labels,<span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">1.2</span>),<span class="dt">cex=</span><span class="fl">0.9</span>)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">### FIGURE CLA </span><span class="al">###</span></span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>graphics<span class="op">::</span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>),<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">2.1</span>,<span class="fl">3.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="cf">for</span>(type <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;CNV&quot;</span>)){</span>
<span id="cb14-9"><a href="#cb14-9"></a>    </span>
<span id="cb14-10"><a href="#cb14-10"></a>    loss &lt;-<span class="st"> </span>LOSS[[type]][<span class="kw">c</span>(<span class="st">&quot;deviance&quot;</span>,<span class="st">&quot;auc&quot;</span>,<span class="st">&quot;class&quot;</span>)]</span>
<span id="cb14-11"><a href="#cb14-11"></a>    choice &lt;-<span class="st"> &quot;paired&quot;</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>    loss &lt;-<span class="st"> </span><span class="kw">lapply</span>(loss,<span class="cf">function</span>(x) x[,<span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;standard_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),<span class="kw">paste0</span>(<span class="st">&quot;adaptive_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),choice)])</span>
<span id="cb14-13"><a href="#cb14-13"></a>    </span>
<span id="cb14-14"><a href="#cb14-14"></a>    <span class="cf">for</span>(constraint <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;10&quot;</span>)){ <span class="co"># c(&quot;5&quot;,&quot;10&quot;,&quot;Inf&quot;)</span></span>
<span id="cb14-15"><a href="#cb14-15"></a>        <span class="co"># change</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>        sub &lt;-<span class="st"> </span><span class="kw">lapply</span>(loss,<span class="cf">function</span>(x) x[<span class="kw">rownames</span>(x)<span class="op">==</span>constraint,])</span>
<span id="cb14-17"><a href="#cb14-17"></a>        palasso<span class="op">:::</span><span class="kw">plot_score</span>(sub<span class="op">$</span>deviance,<span class="dt">choice=</span>choice)</span>
<span id="cb14-18"><a href="#cb14-18"></a>        change &lt;-<span class="st"> </span>sub<span class="op">$</span>deviance[,<span class="dv">7</span>]<span class="op">-</span>sub<span class="op">$</span>deviance[,<span class="op">-</span><span class="dv">7</span>]</span>
<span id="cb14-19"><a href="#cb14-19"></a>        palasso<span class="op">:::</span><span class="kw">plot_box</span>(change,<span class="dt">ylab=</span><span class="st">&quot;change&quot;</span>,<span class="dt">zero=</span><span class="ot">TRUE</span>,<span class="dt">choice=</span><span class="ot">NA</span>)</span>
<span id="cb14-20"><a href="#cb14-20"></a>        <span class="co"># info</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>        info &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb14-22"><a href="#cb14-22"></a>        info<span class="op">$</span>select &lt;-<span class="st"> </span><span class="kw">names</span>(<span class="kw">which.min</span>(<span class="kw">apply</span>(sub<span class="op">$</span>deviance,<span class="dv">2</span>,median)[<span class="op">-</span><span class="dv">7</span>]))</span>
<span id="cb14-23"><a href="#cb14-23"></a>        info<span class="op">$</span>DEV_paired &lt;-<span class="st"> </span><span class="kw">median</span>(sub<span class="op">$</span>deviance[,choice])</span>
<span id="cb14-24"><a href="#cb14-24"></a>        info<span class="op">$</span>DEV_select &lt;-<span class="st"> </span><span class="kw">median</span>(sub<span class="op">$</span>deviance[,info<span class="op">$</span>select])</span>
<span id="cb14-25"><a href="#cb14-25"></a>        info<span class="op">$</span>improve &lt;-<span class="st"> </span><span class="kw">mean</span>(sub<span class="op">$</span>deviance[,info<span class="op">$</span>select]<span class="op">&gt;</span>sub<span class="op">$</span>deviance[,choice])</span>
<span id="cb14-26"><a href="#cb14-26"></a>        info<span class="op">$</span>AUC_paired &lt;-<span class="st"> </span><span class="kw">median</span>(sub<span class="op">$</span>auc[,choice])</span>
<span id="cb14-27"><a href="#cb14-27"></a>        info<span class="op">$</span>CLASS_paired &lt;-<span class="st"> </span><span class="kw">median</span>(sub<span class="op">$</span>class[,choice])</span>
<span id="cb14-28"><a href="#cb14-28"></a>        <span class="kw">print</span>(<span class="kw">as.data.frame</span>(info)) <span class="co"># important</span></span>
<span id="cb14-29"><a href="#cb14-29"></a>    }</span>
<span id="cb14-30"><a href="#cb14-30"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">### FIGURE DEC </span><span class="al">###</span></span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#graphics::par(oma=c(1.0,1.0,0,0),mar=c(1.5,3.0,0.5,0.5),mfrow=c(1,1))</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>graphics<span class="op">::</span><span class="kw">par</span>(<span class="dt">oma=</span><span class="kw">c</span>(<span class="fl">1.0</span>,<span class="fl">1.0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">1.5</span>,<span class="fl">3.0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb15-8"><a href="#cb15-8"></a></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="cf">for</span>(type <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>,<span class="st">&quot;isoform&quot;</span>,<span class="st">&quot;miRNA&quot;</span>,<span class="st">&quot;CNV&quot;</span>)){</span>
<span id="cb15-10"><a href="#cb15-10"></a>    models &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;standard_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),</span>
<span id="cb15-11"><a href="#cb15-11"></a>                <span class="kw">paste0</span>(<span class="st">&quot;adaptive_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),<span class="st">&quot;paired&quot;</span>)</span>
<span id="cb15-12"><a href="#cb15-12"></a>    constraint &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5&quot;</span>,<span class="st">&quot;10&quot;</span>,<span class="st">&quot;15&quot;</span>,<span class="st">&quot;20&quot;</span>,<span class="st">&quot;25&quot;</span>,<span class="st">&quot;50&quot;</span>,<span class="st">&quot;Inf&quot;</span>)</span>
<span id="cb15-13"><a href="#cb15-13"></a>    </span>
<span id="cb15-14"><a href="#cb15-14"></a>    loss &lt;-<span class="st"> </span>LOSS[[type]][<span class="st">&quot;deviance&quot;</span>]</span>
<span id="cb15-15"><a href="#cb15-15"></a>    </span>
<span id="cb15-16"><a href="#cb15-16"></a>    loss &lt;-<span class="st"> </span><span class="kw">lapply</span>(loss,<span class="cf">function</span>(x) x[,models])</span>
<span id="cb15-17"><a href="#cb15-17"></a>    </span>
<span id="cb15-18"><a href="#cb15-18"></a>    table &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="kw">length</span>(constraint),<span class="dt">ncol=</span><span class="kw">length</span>(models),</span>
<span id="cb15-19"><a href="#cb15-19"></a>                    <span class="dt">dimnames=</span><span class="kw">list</span>(constraint,models))</span>
<span id="cb15-20"><a href="#cb15-20"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(constraint)){</span>
<span id="cb15-21"><a href="#cb15-21"></a>        sub &lt;-<span class="st"> </span><span class="kw">lapply</span>(loss,<span class="cf">function</span>(x) x[<span class="kw">rownames</span>(x)<span class="op">==</span>constraint[i],])</span>
<span id="cb15-22"><a href="#cb15-22"></a>        table[i,] &lt;-<span class="st"> </span><span class="kw">apply</span>(sub<span class="op">$</span>deviance,<span class="dv">2</span>,median)</span>
<span id="cb15-23"><a href="#cb15-23"></a>    }</span>
<span id="cb15-24"><a href="#cb15-24"></a>    </span>
<span id="cb15-25"><a href="#cb15-25"></a>    <span class="co"># table &lt;- log(table)</span></span>
<span id="cb15-26"><a href="#cb15-26"></a>    graphics<span class="op">::</span><span class="kw">plot.new</span>()</span>
<span id="cb15-27"><a href="#cb15-27"></a>    graphics<span class="op">::</span><span class="kw">plot.window</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">length</span>(constraint)),<span class="dt">ylim=</span><span class="kw">range</span>(table))</span>
<span id="cb15-28"><a href="#cb15-28"></a>    graphics<span class="op">::</span><span class="kw">box</span>()</span>
<span id="cb15-29"><a href="#cb15-29"></a>    constraint[constraint<span class="op">==</span><span class="st">&quot;Inf&quot;</span>] &lt;-<span class="st"> &quot;n&quot;</span></span>
<span id="cb15-30"><a href="#cb15-30"></a>    graphics<span class="op">::</span><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>)</span>
<span id="cb15-31"><a href="#cb15-31"></a>    graphics<span class="op">::</span><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>,<span class="dt">at=</span><span class="kw">seq_along</span>(constraint),<span class="dt">labels=</span>constraint,<span class="dt">tick=</span><span class="ot">FALSE</span>,<span class="dt">line=</span><span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb15-32"><a href="#cb15-32"></a></span>
<span id="cb15-33"><a href="#cb15-33"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)){</span>
<span id="cb15-34"><a href="#cb15-34"></a>        <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(models)){</span>
<span id="cb15-35"><a href="#cb15-35"></a>            lty &lt;-<span class="st"> </span><span class="kw">ifelse</span>(i<span class="op">%in%</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="dv">3</span>,<span class="kw">ifelse</span>(i<span class="op">%in%</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb15-36"><a href="#cb15-36"></a>            col &lt;-<span class="st"> </span><span class="kw">ifelse</span>(i<span class="op">==</span><span class="dv">7</span>,<span class="st">&quot;#00007F&quot;</span>,<span class="st">&quot;#FF3535&quot;</span>) </span>
<span id="cb15-37"><a href="#cb15-37"></a>            pch &lt;-<span class="st"> </span><span class="kw">ifelse</span>(i<span class="op">%in%</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="st">&quot;x&quot;</span>,<span class="kw">ifelse</span>(i<span class="op">%in%</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>),<span class="st">&quot;z&quot;</span>,<span class="dv">1</span>))</span>
<span id="cb15-38"><a href="#cb15-38"></a>            <span class="cf">if</span>(k<span class="op">==</span><span class="dv">1</span>){</span>
<span id="cb15-39"><a href="#cb15-39"></a>                graphics<span class="op">::</span><span class="kw">lines</span>(table[,i],<span class="dt">col=</span>col,<span class="dt">lty=</span>lty,<span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb15-40"><a href="#cb15-40"></a>                graphics<span class="op">::</span><span class="kw">points</span>(table[,i],<span class="dt">col=</span><span class="st">&quot;white&quot;</span>,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">cex=</span><span class="fl">1.2</span>)</span>
<span id="cb15-41"><a href="#cb15-41"></a>            } <span class="cf">else</span> {</span>
<span id="cb15-42"><a href="#cb15-42"></a>                graphics<span class="op">::</span><span class="kw">points</span>(table[,i],<span class="dt">col=</span>col,<span class="dt">pch=</span><span class="dv">1</span>,<span class="dt">font=</span><span class="dv">2</span>)  </span>
<span id="cb15-43"><a href="#cb15-43"></a>            }</span>
<span id="cb15-44"><a href="#cb15-44"></a>        }</span>
<span id="cb15-45"><a href="#cb15-45"></a>    }</span>
<span id="cb15-46"><a href="#cb15-46"></a>}</span>
<span id="cb15-47"><a href="#cb15-47"></a>graphics<span class="op">::</span><span class="kw">title</span>(<span class="dt">ylab=</span><span class="st">&quot;deviance&quot;</span>,<span class="dt">line=</span><span class="fl">0.0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>)</span>
<span id="cb15-48"><a href="#cb15-48"></a>graphics<span class="op">::</span><span class="kw">title</span>(<span class="dt">xlab=</span><span class="st">&quot;sparsity constraint&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;deviance&quot;</span>,<span class="dt">line=</span><span class="fl">0.0</span>,<span class="dt">outer=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">### FIGURE CNV </span><span class="al">###</span></span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a>graphics<span class="op">::</span><span class="kw">par</span>(<span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">2.1</span>,<span class="fl">3.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb16-7"><a href="#cb16-7"></a>graphics<span class="op">::</span><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="dt">nrow=</span><span class="dv">1</span>))</span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a>loss &lt;-<span class="st"> </span>LOSS[[type]][<span class="kw">c</span>(<span class="st">&quot;deviance&quot;</span>,<span class="st">&quot;auc&quot;</span>,<span class="st">&quot;class&quot;</span>)]</span>
<span id="cb16-10"><a href="#cb16-10"></a>loss &lt;-<span class="st"> </span><span class="kw">lapply</span>(loss,<span class="cf">function</span>(x) x[<span class="kw">rownames</span>(x)<span class="op">==</span><span class="st">&quot;10&quot;</span>,])</span>
<span id="cb16-11"><a href="#cb16-11"></a>model &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&quot;standard_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)),</span>
<span id="cb16-12"><a href="#cb16-12"></a>           <span class="kw">paste0</span>(<span class="st">&quot;adaptive_&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;z&quot;</span>,<span class="st">&quot;xz&quot;</span>)))</span>
<span id="cb16-13"><a href="#cb16-13"></a></span>
<span id="cb16-14"><a href="#cb16-14"></a>diff &lt;-<span class="st"> </span>loss<span class="op">$</span>auc[,<span class="st">&quot;paired&quot;</span>]<span class="op">-</span>loss<span class="op">$</span>auc[,model]</span>
<span id="cb16-15"><a href="#cb16-15"></a>palasso<span class="op">:::</span><span class="kw">plot_box</span>(diff,<span class="dt">zero=</span><span class="ot">TRUE</span>,<span class="dt">invert=</span><span class="ot">TRUE</span>,<span class="dt">ylab=</span><span class="st">&quot;change&quot;</span>)</span>
<span id="cb16-16"><a href="#cb16-16"></a>diff &lt;-<span class="st"> </span>loss<span class="op">$</span>class[,<span class="st">&quot;paired&quot;</span>]<span class="op">-</span>loss<span class="op">$</span>class[,model]</span>
<span id="cb16-17"><a href="#cb16-17"></a>palasso<span class="op">:::</span><span class="kw">plot_box</span>(diff,<span class="dt">zero=</span><span class="ot">TRUE</span>,<span class="dt">ylab=</span><span class="st">&quot;change&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">### FIGURE MAP </span><span class="al">###</span></span>
<span id="cb17-2"><a href="#cb17-2"></a></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a>loss &lt;-<span class="st"> </span>LOSS[[<span class="st">&quot;CNV&quot;</span>]][<span class="kw">c</span>(<span class="st">&quot;info&quot;</span>,<span class="st">&quot;auc&quot;</span>)]</span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a>cancer &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(<span class="kw">levels</span>(loss<span class="op">$</span>info<span class="op">$</span>y0),<span class="kw">levels</span>(loss<span class="op">$</span>info<span class="op">$</span>y1))))</span>
<span id="cb17-9"><a href="#cb17-9"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dt">nrow=</span><span class="kw">length</span>(cancer),<span class="dt">ncol=</span><span class="kw">length</span>(cancer),<span class="dt">dimnames=</span><span class="kw">list</span>(cancer,cancer))</span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#Z &lt;- palasso:::.design(x=cancer)</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>y0 &lt;-<span class="st"> </span><span class="kw">as.character</span>(loss<span class="op">$</span>info<span class="op">$</span>y0)</span>
<span id="cb17-12"><a href="#cb17-12"></a>y1 &lt;-<span class="st"> </span><span class="kw">as.character</span>(loss<span class="op">$</span>info<span class="op">$</span>y1)</span>
<span id="cb17-13"><a href="#cb17-13"></a>X[<span class="kw">cbind</span>(y0,y1)] &lt;-<span class="st"> </span>X[<span class="kw">cbind</span>(y1,y0)] &lt;-<span class="st"> </span>loss<span class="op">$</span>auc[<span class="kw">rownames</span>(loss<span class="op">$</span>auc)<span class="op">==</span><span class="st">&quot;10&quot;</span>,<span class="st">&quot;paired&quot;</span>]</span>
<span id="cb17-14"><a href="#cb17-14"></a></span>
<span id="cb17-15"><a href="#cb17-15"></a>graphics<span class="op">::</span><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">3.0</span>,<span class="fl">3.0</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="kw">dimnames</span>(X) &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">dimnames</span>(X),<span class="cf">function</span>(x) <span class="kw">paste0</span>(<span class="st">&quot;  &quot;</span>,x,<span class="st">&quot;  &quot;</span>))</span>
<span id="cb17-17"><a href="#cb17-17"></a>palasso<span class="op">:::</span><span class="kw">plot_table</span>(<span class="dt">X=</span>X,<span class="dt">margin=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">labels=</span><span class="ot">FALSE</span>,<span class="dt">las=</span><span class="dv">2</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="co">#sort(rowMeans(X,na.rm=TRUE),decreasing=TRUE)[1:2] # keep!</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">### FIGURE COM </span><span class="al">###</span></span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co"># 32 cancer types for isoform and miRNA</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co"># 33 cancer types for gene and CNV</span></span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#rm(list=ls())</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&lt;&lt;functions&gt;&gt;</span></span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="cf">for</span>(type <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;miRNA&quot;</span>)){</span>
<span id="cb18-10"><a href="#cb18-10"></a>    </span>
<span id="cb18-11"><a href="#cb18-11"></a>cancer &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">as.character</span>(<span class="kw">unlist</span>(LOSS[[type]]<span class="op">$</span>info[,<span class="kw">c</span>(<span class="st">&quot;y0&quot;</span>,<span class="st">&quot;y1&quot;</span>)]))))</span>
<span id="cb18-12"><a href="#cb18-12"></a></span>
<span id="cb18-13"><a href="#cb18-13"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(cancer)</span>
<span id="cb18-14"><a href="#cb18-14"></a>z &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(palasso<span class="op">:::</span><span class="kw">.design</span>(<span class="dt">x=</span>n))</span>
<span id="cb18-15"><a href="#cb18-15"></a>x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">seq_len</span>(n),<span class="dt">each=</span>n)</span>
<span id="cb18-16"><a href="#cb18-16"></a>y &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dt">from=</span>n,<span class="dt">to=</span><span class="dv">1</span>,<span class="dt">by=</span><span class="op">-</span><span class="dv">1</span>),<span class="dt">times=</span>n)</span>
<span id="cb18-17"><a href="#cb18-17"></a>    </span>
<span id="cb18-18"><a href="#cb18-18"></a>pch &lt;-<span class="st"> </span>z</span>
<span id="cb18-19"><a href="#cb18-19"></a>pch[pch<span class="op">==</span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>pex &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;.&quot;</span>,<span class="st">&quot;O&quot;</span>,<span class="st">&quot;*&quot;</span>,<span class="st">&quot;+&quot;</span>,<span class="st">&quot;o&quot;</span>,<span class="st">&quot;-&quot;</span>,<span class="st">&quot;&#39;&quot;</span>,<span class="st">&quot;x&quot;</span>)</span>
<span id="cb18-21"><a href="#cb18-21"></a></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="co"># colour</span></span>
<span id="cb18-23"><a href="#cb18-23"></a>base &lt;-<span class="st"> </span>grDevices<span class="op">::</span><span class="kw">colorRampPalette</span>(<span class="dt">colors=</span><span class="kw">c</span>(<span class="st">&#39;darkblue&#39;</span>,<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>,<span class="st">&#39;darkred&#39;</span>))(n)</span>
<span id="cb18-24"><a href="#cb18-24"></a>        </span>
<span id="cb18-25"><a href="#cb18-25"></a>col &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="dt">times=</span><span class="kw">length</span>(z))</span>
<span id="cb18-26"><a href="#cb18-26"></a>col[z<span class="op">==</span><span class="dv">0</span>] &lt;-<span class="st"> &quot;white&quot;</span></span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_len</span>(n)){</span>
<span id="cb18-28"><a href="#cb18-28"></a>    col[z<span class="op">==</span>i] &lt;-<span class="st"> </span>base[i]</span>
<span id="cb18-29"><a href="#cb18-29"></a>}</span>
<span id="cb18-30"><a href="#cb18-30"></a></span>
<span id="cb18-31"><a href="#cb18-31"></a>graphics<span class="op">::</span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb18-32"><a href="#cb18-32"></a>graphics<span class="op">::</span><span class="kw">plot.new</span>()</span>
<span id="cb18-33"><a href="#cb18-33"></a>graphics<span class="op">::</span><span class="kw">plot.window</span>(<span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,n),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">1</span>,n))</span>
<span id="cb18-34"><a href="#cb18-34"></a>graphics<span class="op">::</span><span class="kw">points</span>(<span class="dt">x=</span>x[pch<span class="op">&lt;=</span><span class="dv">25</span>],<span class="dt">y=</span>y[pch<span class="op">&lt;=</span><span class="dv">25</span>],</span>
<span id="cb18-35"><a href="#cb18-35"></a>                 <span class="dt">pch=</span>pch[pch<span class="op">&lt;=</span><span class="dv">25</span>],<span class="dt">col=</span>col[pch<span class="op">&lt;=</span><span class="dv">25</span>],<span class="dt">cex=</span><span class="fl">0.9</span>)</span>
<span id="cb18-36"><a href="#cb18-36"></a>graphics<span class="op">::</span><span class="kw">points</span>(<span class="dt">x=</span>x[pch<span class="op">&gt;</span><span class="dv">25</span>],<span class="dt">y=</span>y[pch<span class="op">&gt;</span><span class="dv">25</span>],</span>
<span id="cb18-37"><a href="#cb18-37"></a>                 <span class="dt">pch=</span>pex[(pch<span class="dv">-25</span>)[pch<span class="op">&gt;</span><span class="dv">25</span>]],<span class="dt">col=</span>col[pch<span class="op">&gt;</span><span class="dv">25</span>],<span class="dt">cex=</span><span class="fl">0.9</span>)</span>
<span id="cb18-38"><a href="#cb18-38"></a>graphics<span class="op">::</span><span class="kw">segments</span>(<span class="dt">x0=</span><span class="dv">0</span>,<span class="dt">x1=</span>n<span class="op">+</span><span class="dv">1</span>,<span class="dt">y0=</span>n<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb18-39"><a href="#cb18-39"></a>graphics<span class="op">::</span><span class="kw">segments</span>(<span class="dt">x0=</span>n<span class="op">+</span><span class="dv">1</span>,<span class="dt">y0=</span>n<span class="op">+</span><span class="dv">1</span>,<span class="dt">y1=</span><span class="dv">0</span>)</span>
<span id="cb18-40"><a href="#cb18-40"></a>graphics<span class="op">::</span><span class="kw">segments</span>(<span class="dt">x0=</span><span class="dv">0</span>,<span class="dt">x1=</span>n<span class="op">+</span><span class="dv">1</span>,<span class="dt">y0=</span>n<span class="op">+</span><span class="dv">1</span>,<span class="dt">y1=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb18-41"><a href="#cb18-41"></a></span>
<span id="cb18-42"><a href="#cb18-42"></a>graphics<span class="op">::</span><span class="kw">mtext</span>(<span class="dt">text=</span>cancer,<span class="dt">side=</span><span class="dv">3</span>,<span class="dt">at=</span><span class="dv">1</span><span class="op">:</span>n,<span class="dt">las=</span><span class="dv">2</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</span>
<span id="cb18-43"><a href="#cb18-43"></a>graphics<span class="op">::</span><span class="kw">mtext</span>(<span class="dt">text=</span>cancer,<span class="dt">side=</span><span class="dv">4</span>,<span class="dt">at=</span>n<span class="op">:</span><span class="dv">1</span>,<span class="dt">las=</span><span class="dv">2</span>,<span class="dt">cex=</span><span class="fl">0.7</span>)</span>
<span id="cb18-44"><a href="#cb18-44"></a></span>
<span id="cb18-45"><a href="#cb18-45"></a>}</span></code></pre></div>
<hr />
<hr />
<hr />
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
